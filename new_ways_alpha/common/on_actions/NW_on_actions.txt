on_actions = {
	on_startup = {
		effect = {
			set_global_flag = { flag = nw_drop_focus_tree value = 1 days = 2 }
			### INFRA IN STATE BONUS
			every_state = {
				limit = {
					OR = {
						state = 1088 state = 1097 state = 72 state = 766 state = 1037 state = 821 state = 820 state = 118 state = 1042 state = 1066 state = 822 state = 819 state = 823 state = 904 state = 102 state = 907 state = 906 state = 163 state = 815 state = 814 state = 801 state = 802 state = 803
					}
				}
				set_variable = { state_infra_var = 0.75 }
				add_dynamic_modifier = { modifier = infra_in_state_dyn }
				force_update_dynamic_modifier = yes
			}
			every_state = {
				limit = {
					OR = {
						state = 1002 state = 1001 state = 1111 state = 1120 state = 188 state = 770 state = 803 state = 764 state = 765 state = 145 state = 974 state = 1038 state = 1061 state = 973 state = 116 state = 858 state = 848 state = 847 state = 80 state = 838 state = 818 state = 77 state = 341 state = 964 state = 945 state = 1075 state = 940 state = 799 state = 997 state = 989 state = 817 state = 972 state = 895 state = 971 state = 967 state = 966 state = 969 state = 965 state = 798 state = 768 state = 937 state = 1029 state = 779
					}
				}
				set_variable = { state_infra_var = 0.5 }
				add_dynamic_modifier = { modifier = infra_in_state_dyn }
				force_update_dynamic_modifier = yes
			}
			every_state = {
				limit = {
					OR = {
						state = 1105 state = 1109 state = 124 state = 35 state = 975 state = 811 state = 905 state = 103 state = 845 state = 783 state = 780 state = 772 state = 183 state = 1153 state = 979 state = 656 state = 773 state = 804 state = 87 state = 825 state = 212 state = 1026 state = 184 state = 782 state = 894 state = 837 state = 988 state = 990 state = 807 state = 813 state = 856 state = 187 state = 1025 state = 164 state = 1100 state = 553 state = 1101 state = 961 state = 1093 state = 701
					}
				}
				set_variable = { state_infra_var = 0.25 }
				add_dynamic_modifier = { modifier = infra_in_state_dyn }
				force_update_dynamic_modifier = yes
			}
			every_state = {
				limit = {
					OR = {
						state = 408 state = 409 state = 657 state = 561 state = 666 state = 863 state = 585 state = 584 state = 407 state = 573 state = 957 state = 329 state = 565 state = 567 state = 563 state = 376 state = 377 state = 393 state = 276 state = 1089 state = 1086 state = 331 state = 1083 state = 1082 state = 1081 state = 1079 state = 1085 state = 271 state = 1080 state = 550 state = 269 state = 547 state = 295 state = 1065 state = 542 state = 681 state = 719 state = 272 state = 755 state = 607 state = 620 state = 602 state = 600 state = 598 state = 596 state = 595 state = 593 state = 599 state = 594 state = 524 state = 527 state = 539 state = 521 state = 285 state = 519 state = 520 state = 723 state = 924 state = 468 state = 487 state = 499 state = 496 state = 505 state = 792 state = 172 state = 680 state = 416 state = 411 state = 414 state = 410 state = 412 state = 425 state = 424 state = 427 state = 436 state = 438 state = 433 state = 440 state = 228 state = 640 state = 670 state = 671 state = 672 state = 334 state = 669 state = 482 state = 483 state = 484 state = 456 state = 769 state = 797 state = 1115 state = 293 state = 343 state = 348 state = 350 state = 352 state = 344 state = 837 state = 106 state = 185 state = 47 state = 148 state = 587 state = 402
					}
				}
				set_variable = { state_infra_var = -0.25 }
				add_dynamic_modifier = { modifier = infra_in_state_dyn }
				force_update_dynamic_modifier = yes
			}
			every_state = {
				limit = {
					OR = {
						state = 637 state = 886 state = 915 state = 887 state = 718 state = 538 state = 506 state = 574 state = 575 state = 576 state = 577 state = 580 state = 581 state = 214 state = 215 state = 213 state = 144 state = 404 state = 956 state = 330 state = 955 state = 954 state = 953 state = 330 state = 930 state = 375 state = 378 state = 380 state = 388 state = 473 state = 470 state = 469 state = 682 state = 467 state = 466 state = 1060 state = 663 state = 662 state = 661 state = 1068 state = 699 state = 556 state = 557 state = 1011 state = 1012 state = 928 state = 1013 state = 1019 state = 549 state = 767 state = 1051 state = 559 state = 830 state = 1114 state = 541 state = 1110 state = 983 state = 544 state = 543 state = 660 state = 1005 state = 549 state = 1006 state = 558 state = 1011 state = 1012 state = 323 state = 1104 state = 902 state = 434 state = 280 state = 929 state = 998 state = 292 state = 679 state = 944 state = 1119
					}
				}
				set_variable = { state_infra_var = -0.5 }
				add_dynamic_modifier = { modifier = infra_in_state_dyn }
				force_update_dynamic_modifier = yes
			}
			every_state = {
				limit = {
					OR = {
						state = 262 state = 463 state = 911 state = 379 state = 1087 state = 101 state = 100 state = 453 state = 452 state = 1067 state = 757 state = 758 state = 601 state = 833 state = 324 state = 674 state = 495 state = 675 state = 457 state = 1054 state = 1055 state = 1116
						impassable = yes
					}
				}
				set_variable = { state_infra_var = -1 }
				add_dynamic_modifier = { modifier = infra_in_state_dyn }
				force_update_dynamic_modifier = yes
			}
			
			
			### AI_DIVISION_LIMITER_DYNAMIC
			if = {
				limit = {
					has_game_rule = { rule = ai_division_limiter_status option = AI_DIVISION_LIMITER_DYNAMIC }
				}
				every_country = {
					set_variable = { ai_upper_limit = num_of_factories }
					multiply_variable = { ai_upper_limit = 1.15 }
					if = {
						limit = { is_major = yes }
						multiply_variable = { ai_upper_limit = 1.15 }
					}
					if = {
						limit = { has_war = yes }
						multiply_variable = { ai_upper_limit = 1.2 }
					}
					if = {
						limit = { threat > 0.74 }
						multiply_variable = { ai_upper_limit = 1.05 }
					}
					round_variable = ai_upper_limit
				}
			}
			### AI_DIVISION_LIMITER SPECIAL BLOCK FOR AMERICA
			every_country = {
				limit = {
					OR = {
						capital_scope = { is_on_continent = south_america }
						capital_scope = { is_on_continent = north_america }
					}
				}
				add_to_array = { global.start_americans = THIS }
			}
			### volunteer_only
			every_country = {
				limit = {
					has_idea = volunteer_only
					NOT = { has_dynamic_modifier = { modifier = volunteer_only_dyn } }
				}
				set_variable = { volunteer_only_var = party_popularity@ruling_party }
				multiply_variable = { volunteer_only_var = has_war_support }
				multiply_variable = { volunteer_only_var = 0.0045 }
				subtract_from_variable = { volunteer_only_var = 0.015 }
				add_dynamic_modifier = { modifier = volunteer_only_dyn }
			}
			
			### АЛЬТОВЫЕ СЦЕНАРИИ
			if = {
				limit = {
					OR = {
						has_global_flag = THE_MOTHER_OF_ORDER_FLAG
						has_global_flag = WORLD_OF_SPLIT_FLAG
					}
				}
				#set_global_flag = AI_AGGRESSION_ULTRA_FLAG
				every_country = {
					limit = { NOT = { has_focus_tree = generic_focus } }
					load_focus_tree = { tree = generic_focus keep_completed = no }
					every_unit_leader = {
						retire = yes
					}
				}
				every_country = {
					limit = { has_government = anarchism }
					country_event = { id = TRpolitical.106 }
				}
				every_country = {
					limit = { has_war_with = JAP }
					every_enemy_country = { white_peace = PREV }
				}
				every_country = {
					limit = { is_faction_leader = yes }
					dismantle_faction = yes
				}
				#every_country = {
				#	add_ideas = {
				#		volunteer_only
				#		civilian_economy
				#		ai_aggression_ultra_idea
				#	}
				#	set_political_power = 0
				#	set_stability = 0.5
				#	set_war_support = 0.5
				#	set_research_slots = 4
				#	
				#	#Приколюхи, ага
				#	set_technology = {
				#		atomic_research = 1
				#		nuclear_reactor = 1
				#		nukes = 1
				#	}
				#	add_nuclear_bombs = 100
				#}
				random_country = {
					limit = { is_ai = no }
					log = "[GetDateText]: [This.GetName] ([This.GetTag]): IS ADJUSTER"
					country_event = { id = NWgeneric.9998 }
				}
				set_variable = { global.total_trozkist = 0 }
				every_country = {
					limit = {
						has_government = trozkism
						NOT = {
							has_country_leader = { name = "Nikolas Roerich" ruling_only = yes }
						}
					}
					add_to_variable = { global.total_trozkist = 1 }
					if = {
						limit = { NOT = { has_dynamic_modifier = { modifier = troz_threat_dyn } } }
						add_dynamic_modifier = { modifier = troz_threat_dyn }
					}
					if = {
						limit = { NOT = { has_country_flag = is_trozkist_country_flag } }
						set_country_flag = is_trozkist_country_flag
					}
					if = {
						limit = { num_of_factories > 49 }
						add_to_variable = { global.troz_threat_var = 3 }
						log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): добавил 3 тронапряги как мажор"
					}
					else_if = {
						limit = { num_of_factories > 24 }
						add_to_variable = { global.troz_threat_var = 2 }
						log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): добавил 2 тронапряги как миддл"
					}
					else = {
						add_to_variable = { global.troz_threat_var = 1 }
						log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): добавил 1 тронапряги как минор)0"
					}
				}
				random_country = {
					limit = {
						has_government = trozkism
						NOT = {
							has_country_leader = { name = "Nikolas Roerich" ruling_only = yes }
						}
					}
					set_var_for_troz_threat_dyn = yes
				}
				random_country = {
					limit = { num_of_controlled_states > 1 }
					set_country_flag = NWgeneric_9999_flag
					log = "[GetDateText]: [This.GetName] ([This.GetTag]): СТРАНА SAI"
					random_owned_state = {
						log = "[GetDateText]: [This.GetName] ([This.GetID]): СТЕЙТ SAI"
						SAI = { transfer_state = PREV }
					}
				}
				every_country = {
					transfer_navy = {
						target = SAI
					}
				}
				random_country = {
					limit = { has_country_flag = NWgeneric_9999_flag }
					clr_country_flag = NWgeneric_9999_flag
					annex_country = {
						target = SAI
						transfer_troops = no
					}
				}
				
				### МИР РАСКОЛА
				if = {
					limit = { has_global_flag = WORLD_OF_SPLIT_FLAG }
					every_country = {
						limit = { is_subject = yes }
						drop_cosmetic_tag = yes
						OVERLORD = {
							set_autonomy = {
								target = PREV
								autonomy_state = autonomy_free
							}
						}
					}
					BUL = {
						start_civil_war = {
							ideology = fascism
							size = 0.5
						} 
					}
				}
			}
			#random_country = {
			#	set_country_flag = timer_timer_flag
			#	log = "[GetDateText]: [This.GetName] ([This.GetTag]): Избран крикуном"
			#}
			#Configurator
			#random_country = {
			#	limit = { is_ai = no }
			#	set_global_flag = nw_configurator_open
			#}
			
			if = {
				limit = { has_start_date < 1936.1.2 }
				random_country = { #1 мая the_gathering_storm
					country_event = { id = NWgeneric.15 days = 120 }
				}
			}
			else_if = {
				limit = {
					has_start_date > 1936.1.2
					has_start_date < 1939.8.15
				}
				random_country = { #1 мая blitzkrieg
					country_event = { id = NWgeneric.15 days = 261 }
				}
			}
			else_if = {
				limit = {
					has_start_date > 1940.1.1
					has_start_date < 1940.1.3
				}
				random_country = { #1 мая the_mother_of_order
					country_event = { id = NWgeneric.15 days = 119 }
				}
			}
			else_if = {
				limit = {
					has_start_date > 1941.12.4
					has_start_date < 1941.12.6
				}
				random_country = { #1 мая world_of_split_name
					country_event = { id = NWgeneric.15 days = 147 }
				}
			}
			
			set_variable = { counter_days = 0 }
			
			### Delete SAI // убран с карты по дефолту
			#CHL = { transfer_state = 933 }
			#933 = { remove_core_of = SAI }
			
			### Start legitimacy
			every_country = {
				country_event = { id = TRlegitimacy.8 }
				country_event = { id = tmo.migration.9 }
			}
			#if = {
			#	limit = {
			#		is_historical_focus_on = no
			#		has_start_date < 1936.1.2
			#	}
			#	every_country = {
			#		limit = {
			#			OR = {
			#				has_focus_tree = generic_focus
			#				has_focus_tree = generic_anarchism_focus
			#			}
			#			democratic < 1
			#			communism < 1
			#			fascism < 1
			#			neutrality < 1
			#			technocracy < 1
			#			trozkism < 1
			#			monarchy < 1
			#			anarchism < 1
			#		}
			#		random_list = {
			#			50 = { }
			#			20 = { add_popularity = { ideology = technocracy popularity = 0.2 } }
			#			10 = { add_popularity = { ideology = technocracy popularity = 0.15 } }
			#			10 = { add_popularity = { ideology = technocracy popularity = 0.1 } }
			#			10 = { add_popularity = { ideology = technocracy popularity = 0.05 } }
			#		}
			#	}
			#}
			every_country = {
				limit = {
					OR = {
						tag = LIE
						tag = DNZ
						tag = ADR
						tag = MNC
						tag = TNR
						tag = GBT
						tag = SMA
						tag = VAT
					}
					is_ai = yes
				}
				set_rule = { can_join_factions = no }
				set_rule = { can_create_factions = no }
				add_ideas = justify_minor_idea
				log = "[GetDateText]: [This.GetName] ([This.GetTag]): запрет вступать в альянсы"
			}
			
			if = {
				limit = {
					has_game_rule = {
						rule = trade_weapons
						option = DEFAULT
					}
				}
				random_country = {
					limit = { is_ai = no }
					set_variable = {
						var = global.total_infantry_weapons
						value = 0
					}
					set_variable = {
						var = global.total_artillery
						value = 0
					}
					set_variable = {
						var = global.total_support
						value = 0
					}
					set_variable = {
						var = global.total_motorized
						value = 0
					}
					set_variable = {
						var = global.total_mechanized
						value = 0
					}
					set_variable = {
						var = global.total_light_tanks
						value = 0
					}
					set_variable = {
						var = global.total_air_light_fighter
						value = 0
					}
					set_variable = {
						var = global.total_air_heavy_fighter
						value = 0
					}
				}
				#random_country = {
				#	limit = { is_ai = yes }
				#	country_event = { id = TRpolitical.35 days = 365 random_days = 30 }
				#}
			}
			
			### generic_tree_all_allowed
			if = {
				limit = {
					has_game_rule = {
						rule = generic_tree_all_allowed
						option = GENERIC_ALLOWED_ALL
					}
				}
				set_global_flag = generic_all_flag
			}
			
			### generic_tree_all_set_ideology
			if = {
				limit = {
					NOT = {
						has_game_rule = {
							rule = generic_tree_all_set_ideology
							option = DEFAULT
						}
					}
				}
				set_global_flag = generic_all_flag
				if = {
					limit = {
						has_game_rule = {
							rule = generic_tree_all_set_ideology
							option = GENERIC_ALL_SET_DEMOCRATIC
						}
					}
					set_global_flag = generic_all_set_democratic_flag
				}
				else_if = {
					limit = {
						has_game_rule = {
							rule = generic_tree_all_set_ideology
							option = GENERIC_ALL_SET_COMMUNISM
						}
					}
					set_global_flag = generic_all_set_communism_flag
				}
				else_if = {
					limit = {
						has_game_rule = {
							rule = generic_tree_all_set_ideology
							option = GENERIC_ALL_SET_FASCISM
						}
					}
					set_global_flag = generic_all_set_fascism_flag
				}
				else_if = {
					limit = {
						has_game_rule = {
							rule = generic_tree_all_set_ideology
							option = GENERIC_ALL_SET_NEUTRALITY
						}
					}
					set_global_flag = generic_all_set_neutrality_flag
				}
				else_if = {
					limit = {
						has_game_rule = {
							rule = generic_tree_all_set_ideology
							option = GENERIC_ALL_SET_TECHNOCRACY
						}
					}
					set_global_flag = generic_all_set_technocracy_flag
				}
				else_if = {
					limit = {
						has_game_rule = {
							rule = generic_tree_all_set_ideology
							option = GENERIC_ALL_SET_TROZKISM
						}
					}
					set_global_flag = generic_all_set_trozkism_flag
				}
				else_if = {
					limit = {
						has_game_rule = {
							rule = generic_tree_all_set_ideology
							option = GENERIC_ALL_SET_MONARCHY
						}
					}
					set_global_flag = generic_all_set_monarchy_flag
				}
				else_if = {
					limit = {
						has_game_rule = {
							rule = generic_tree_all_set_ideology
							option = GENERIC_ALL_SET_ANARCHISM
						}
					}
					set_global_flag = generic_all_set_anarchism_flag
				}
			}
			
			### generic_spawn_anarchists
			if = {
				limit = {
					has_game_rule = {
						rule = generic_spawn_anarchists
						option = GENERIC_SPAWN_ANARCHISTS_ONE
					}
				}
				random_country = {
					limit = {
						exists = yes
						is_ai = yes
						NOT = {
							tag = TIG
							has_government = anarchism
							has_country_flag = generic_spawn_anarchists_flag
						}
						NOT = {
							is_subject = yes
							OVERLORD = { has_government = fascism }
						}
						has_focus_tree = generic_focus
						num_of_controlled_states > 1
					}
					log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): выбран анархистом"
					set_country_flag = generic_spawn_anarchists_flag
				}
			}
			else_if = {
				limit = {
					has_game_rule = {
						rule = generic_spawn_anarchists
						option = GENERIC_SPAWN_ANARCHISTS_TWO
					}
				}
				random_country = {
					limit = {
						exists = yes
						is_ai = yes
						NOT = {
							tag = TIG
							has_government = anarchism
							has_country_flag = generic_spawn_anarchists_flag
						}
						NOT = {
							is_subject = yes
							OVERLORD = { has_government = fascism }
						}
						has_focus_tree = generic_focus
						num_of_controlled_states > 1
					}
					log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): выбран анархистом"
					set_country_flag = generic_spawn_anarchists_flag
				}
				random_country = {
					limit = {
						exists = yes
						is_ai = yes
						NOT = {
							tag = TIG
							has_government = anarchism
							has_country_flag = generic_spawn_anarchists_flag
						}
						NOT = {
							is_subject = yes
							OVERLORD = { has_government = fascism }
						}
						has_focus_tree = generic_focus
						num_of_controlled_states > 1
					}
					log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): выбран анархистом"
					set_country_flag = generic_spawn_anarchists_flag
				}
			}
			else_if = {
				limit = {
					has_game_rule = {
						rule = generic_spawn_anarchists
						option = GENERIC_SPAWN_ANARCHISTS_THREE
					}
				}
				random_country = {
					limit = {
						exists = yes
						is_ai = yes
						NOT = {
							tag = TIG
							has_government = anarchism
							has_country_flag = generic_spawn_anarchists_flag
						}
						NOT = {
							is_subject = yes
							OVERLORD = { has_government = fascism }
						}
						has_focus_tree = generic_focus
						num_of_controlled_states > 1
					}
					log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): выбран анархистом"
					set_country_flag = generic_spawn_anarchists_flag
				}
				random_country = {
					limit = {
						exists = yes
						is_ai = yes
						NOT = {
							tag = TIG
							has_government = anarchism
							has_country_flag = generic_spawn_anarchists_flag
						}
						NOT = {
							is_subject = yes
							OVERLORD = { has_government = fascism }
						}
						has_focus_tree = generic_focus
						num_of_controlled_states > 1
					}
					log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): выбран анархистом"
					set_country_flag = generic_spawn_anarchists_flag
				}
				random_country = {
					limit = {
						exists = yes
						is_ai = yes
						NOT = {
							tag = TIG
							has_government = anarchism
							has_country_flag = generic_spawn_anarchists_flag
						}
						NOT = {
							is_subject = yes
							OVERLORD = { has_government = fascism }
						}
						has_focus_tree = generic_focus
						num_of_controlled_states > 1
					}
					log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): выбран анархистом"
					set_country_flag = generic_spawn_anarchists_flag
				}
			}
			
			### Wonder
			if = {
				limit = {
					OR = {
						has_game_rule = {
							rule = miracles_status
							option = MIRACLES
						}
						has_game_rule = {
							rule = miracles_status
							option = MIRACLES_AND_MOAI
						}
					}
				}
				random_country = {
					news_event = { id = trworldnews.35 hours = 3 }
					news_event = { id = trworldnews.36 hours = 4 }
				}
				2 = { set_state_flag = kolizeum_wonder_flag }
				616 = { set_state_flag = great_wall_wonder_flag }
				621 = { set_state_flag = great_wall_wonder_flag }
				611 = { set_state_flag = great_wall_wonder_flag }
				608 = { set_state_flag = great_wall_wonder_flag }
				609 = { set_state_flag = great_wall_wonder_flag }
				494 = { set_state_flag = machu_pikchu_wonder_flag }
				455 = { set_state_flag = petra_wonder_flag }
				437 = { set_state_flag = taj_mahal_wonder_flag }
				500 = { set_state_flag = cristos_redentor_wonder_flag }
				474 = { set_state_flag = chichen_itza_wonder_flag }
				341 = { set_state_flag = sobor_sofia_wonder_flag }
				1024 = { set_state_flag = afin_acropol_wonder_flag }
				173 = { set_state_flag = algambra_wonder_flag }
				741 = { set_state_flag = angkor_wonder_flag }
				933 = { set_state_flag = moai_wonder_flag }
				219 = { set_state_flag = kremlin_wonder_flag }
				52 = { set_state_flag = noishvanshtain_wonder_flag }
				552 = { set_state_flag = piramids_wonder_flag }
				358 = { set_state_flag = statuya_liberty_wonder_flag }
				338 = { set_state_flag = stonehenge_wonder_flag }
				556 = { set_state_flag = tombuktu_wonder_flag }
				531 = { set_state_flag = temple_kiemidzu_dera_wonder_flag }
				16 = { set_state_flag = eiffel_tower_wonder_flag }
				set_global_flag = wonder_yes
				
				2 = { controller = { add_to_variable = { var = wonder_thief_score value = 1 } add_ideas = kolizeum_wonder } }
				616 = { controller = { add_to_variable = { var = wonder_thief_score value = 1 } } }
				621 = { controller = { add_to_variable = { var = wonder_thief_score value = 1 } } }
				611 = { controller = { add_to_variable = { var = wonder_thief_score value = 1 } } }
				608 = { controller = { add_to_variable = { var = wonder_thief_score value = 1 } } }
				609 = { controller = { add_to_variable = { var = wonder_thief_score value = 1 } } }
				494 = { controller = { add_to_variable = { var = wonder_thief_score value = 1 } add_ideas = machu_pikchu_wonder } }
				455 = { controller = { add_to_variable = { var = wonder_thief_score value = 1 } add_ideas = petra_wonder } }
				437 = { controller = { add_to_variable = { var = wonder_thief_score value = 1 } add_ideas = taj_mahal_wonder } }
				500 = { controller = { add_to_variable = { var = wonder_thief_score value = 1 } add_ideas = cristos_redentor_wonder } }
				474 = { controller = { add_to_variable = { var = wonder_thief_score value = 1 } add_ideas = chichen_itza_wonder } }
				341 = { controller = { add_to_variable = { var = wonder_thief_score value = 1 } add_ideas = sobor_sofia_wonder } }
				1024 = { controller = { add_to_variable = { var = wonder_thief_score value = 1 } add_ideas = afin_acropol_wonder } }
				173 = { controller = { add_to_variable = { var = wonder_thief_score value = 1 } add_ideas = algambra_wonder } }
				741 = { controller = { add_to_variable = { var = wonder_thief_score value = 1 } add_ideas = angkor_wonder } }
				933 = { controller = { add_to_variable = { var = wonder_thief_score value = 1 } } } 	#no wonder
				219 = { controller = { add_to_variable = { var = wonder_thief_score value = 1 } add_ideas = kremlin_wonder } }
				52 = { controller = { add_to_variable = { var = wonder_thief_score value = 1 } add_ideas = noishvanshtain_wonder } }
				552 = { controller = { add_to_variable = { var = wonder_thief_score value = 1 } add_ideas = piramids_wonder } }
				358 = { controller = { add_to_variable = { var = wonder_thief_score value = 1 } add_ideas = statuya_liberty_wonder } }
				338 = { controller = { add_to_variable = { var = wonder_thief_score value = 1 } add_ideas = stonehenge_wonder } }
				556 = { controller = { add_to_variable = { var = wonder_thief_score value = 1 } add_ideas = tombuktu_wonder } }
				531 = { controller = { add_to_variable = { var = wonder_thief_score value = 1 } add_ideas = temple_kiemidzu_dera_wonder } }
				16 = { controller = { add_to_variable = { var = wonder_thief_score value = 1 } add_ideas = eiffel_tower_wonder } }
				every_country = {
					limit = { any_controlled_state = { has_state_flag = great_wall_wonder_flag } }
					country_event = { id = TR.wonder.29 }
				}
				### Start pointer great china wall
				every_country = {
					set_variable = {
						var = bonus_gw
						value = 0
					}
				}
				if = {
					limit = {
						has_game_rule = {
							rule = miracles_status
							option = MIRACLES_AND_MOAI
						}
					}
					set_global_flag = magic_moai
					933 = { controller = { country_event = { id = TR.wonder.13 } } }
					else = {
						933 = { controller = { add_ideas = moai_wonder } }
					}
				}
			}
			
			if = {
				limit = {
					has_start_date < 1936.01.02
				}
				### Spain
				SPR = {
					country_event = { id = NWspain.2 days = 9 }
					country_event = { id = NWspain.3 days = 12 random_days = 2 }
					country_event = { id = NWspain.990 days = 15 } #Пульсар
					country_event = { id = NWspain.5 days = 44 }
				}
				
				# Poland
				POL = { country_event = { id = poland.flavor.2 days = 314 } }
				
				# Greece
				GRE = {
					country_event = { id = nw_greece.1 days = 26 }
					country_event = { id = nw_greece.14 days = 730 }
				}
			}
			set_variable = { var = var_add_pop value = 0 }
			
			if = {
				limit = {
					has_start_date > 1939.01.01
					has_start_date < 1940.01.01
				}
				POL = { country_event = { id = poland.flavor.2 days = 89 } }
			}
			#POL = { country_event = { id = poland.story.1 } }
			
			if = {
				limit = {
					OR = {
						has_game_rule = {
							rule = ai_aggression_status
							option = AI_AGGRESSION_ULTRA
						}
						has_global_flag = AI_AGGRESSION_ULTRA_FLAG
					}
				}
				every_country = {
					add_ideas = ai_aggression_ultra_idea
					set_rule = {
						can_declare_war_on_same_ideology = yes
						can_only_justify_war_on_threat_country = no
					}
				}
			}
			
			if = {
				limit = {
					has_game_rule = {
						rule = ai_faction_status
						option = AI_FACTION_NO
					}
				}
				every_country = {
					limit = { is_ai = yes }
					set_rule = { can_join_factions = no }
				}
			}
			### Цейлон стартпак
			if = {
				limit = {
					has_start_date < 1936.01.02
				}
				LKA = {
					country_event = { id = lka.11 days = 69 }
					country_event = { id = lka.12 days = 458 }
					country_event = { id = lka.13 days = 490 }
					country_event = { id = lka.14 days = 503 }
					country_event = { id = lka.33 days = 315 }
				}
			}
			### FRA Попытка фашистского государственного переворота
			if = {
				limit = { has_start_date < 1936.01.02 }
				FRA = { country_event = { id = NWfrance.51 months = 22 days = 16 hours = 13 } }
			}
			### Либерия стартпак
			if = {
				limit = {
					has_start_date < 1936.01.02
				}
				LIB = {
					country_event = { id = nw_liberia.100 days = 215 }
				}
				#Liberian oil
				if = {
					limit = {
						has_dlc = "Man the Guns"
					}
					LIB = {
						give_resource_rights = { receiver = USA state = 298 }
						give_resource_rights = { receiver = USA state = 1076 }
						give_resource_rights = { receiver = USA state = 1077 }
						give_resource_rights = { receiver = USA state = 1072 }
						give_resource_rights = { receiver = USA state = 1074 }
						give_resource_rights = { receiver = USA state = 1069 }
						give_resource_rights = { receiver = USA state = 1078 }
					}
				}
			}
			### Иран стартпак
			if = {
				limit = {
					has_start_date < 1936.01.02
				}
				PER = {
					country_event = { id = NWpersian.91 days = 7 }
					country_event = { id = NWpersian.153 days = 60 }
				}
			}
			### Ирак стартпак
			if = {
				limit = {
					has_dlc = "Man the Guns"
					has_start_date < 1936.01.02
				}
				IRQ = {
					give_resource_rights = { receiver = ENG state = 676 }
					country_event = { id = NWiraq.3 days = 299 }
					country_event = { id = NWiraq.13 days = 588 }
					country_event = { id = NWiraq.48 days = 397 }
					country_event = { id = NWiraq.50 days = 742 }
					country_event = { id = NWiraq.52 days = 1127 }
				}
			}
			### Палестина стартпак
			if = {
				limit = {
					has_start_date < 1936.01.02
				}
				BPL = {
					country_event = { id = NWpalestine.8 days = 792 }
					country_event = { id = NWpalestine.65 days = 229 }
				}
			}
			### Слоны стартовые стейты
			every_state = {
				limit = {
					OR = {
						is_on_continent = africa
						is_core_of = RAJ
						is_core_of = NEP
						is_core_of = BHU
						is_core_of = SIA
						is_core_of = FIC
						is_core_of = LAO
						is_core_of = CAM
						is_core_of = VIN
						is_core_of = LKA
						is_core_of = SKM
					}
				}
				set_state_flag = elephant_spawn_state_flag
				add_dynamic_modifier = { modifier = state_elephants_modifier_dyn }
			}
			### Турок стартпак
			set_global_flag = NW_TUR_OLD_FOCUS_TREE 
			if = {
				limit = {
					has_start_date < 1936.01.02
				}
				TUR = {
					country_event = { id = NW_new_turkey.133 days = 146 }
				}
				if = {
					limit = {
						has_global_flag = NW_TUR_OLD_FOCUS_TREE 
					}
					TUR = {
						add_country_leader_trait = ataturk_trait
						country_event = { id = NWturkey.10 days = 1044 }
					}
				}
				else = {
					TUR = {
						add_country_leader_trait = peace_in_country_world_peace
						add_country_leader_trait = modernization
						add_country_leader_trait = reformator
						add_country_leader_trait = seriously_ill
						country_event = { id = NW_new_turkey.56 days = 1044 }
						country_event = { id = NW_new_turkey.132 days = 60 }
						country_event = { id = NWkurd.0 days = 305 }
						country_event = { id = NWkurd.2 days = 444 }
						every_controlled_state = {
							limit = { is_on_continent = europe }
							TUR = { add_to_variable = { turkey_europe_controlled_state = 1 } }
						}
					}
				}
			}
			
			### Ньюф стартпак
			NFL = {
				country_event = { id = Newfoundland.7 days = 3 }
			}
			if = {
				limit = {
					has_start_date < 1936.01.02
				}
				#смерть Элдердайса
				NFL = {
					country_event = { id = Newfoundland.72 days = 57 }
				}
				#вопрос о губернаторе
				ENG = {
					country_event = { id = Newfoundland.8 days = 218 }
				}
			}
			
			### Египет стартпак
			if = {
				limit = {
					has_start_date < 1936.01.02
				}
				EGY = {
					country_event = { id = egy.65 days = 5 }
					country_event = { id = egy.59 days = 25 }
					country_event = { id = egy.60 days = 40 }
					country_event = { id = egy.3 days = 118 }
					country_event = { id = egy.4 days = 126 }
					country_event = { id = egy.5 days = 129 }
					country_event = { id = egy.63 days = 159 }
					country_event = { id = egy.64 days = 173 }
					country_event = { id = egy.58 days = 274 }
					country_event = { id = egy.61 days = 356 }
					country_event = { id = egy.62 days = 493 }
					country_event = { id = egy.6 days = 566 }
					country_event = { id = egy.7 days = 750 }
					country_event = { id = egy.75 days = 1133 }
					country_event = { id = egy.8 days = 2886 }
					country_event = { id = egy.9 days = 2896 }
				}
			}
			
			### Бельгия стартпак
			if = {
				limit = {
					has_start_date < 1936.01.02
				}
				BEL = {
					country_event = { id = NWbelgium.150 days = 1091 }
				}
			}
			
			#Непал стартпак
			if = {
				limit = {
					has_start_date < 1936.01.02
				}
				NEP = {
					country_event = { id = nepal.30 days = 201 }
					country_event = { id = nepal.21 days = 399 }
				}
			}
			
			#Бутан стартпак
			if = {
				limit = {
					has_start_date < 1936.01.02
				}
				BHU = {
					country_event = { id = NWbhutan.1 days = 1805 }
					
				}
			}
			
			#Непал стартпак
			if = {
				limit = {
					has_start_date < 1936.01.02
				}
				NEP = {
					country_event = { id = nepal.0 days = 493 }
					
				}
			}
			
			### Тибет стартпак
			if = {
				limit = {
					has_start_date < 1936.01.02
				}
				TIB = {
					country_event = { days = 40 id = tibet.48 }
					country_event = { days = 240 id = tibet.42 }
					country_event = { days = 410 id = tibet.43 }
					country_event = { days = 420 id = tibet.44 }
					country_event = { days = 420 id = tibet.44 }
					country_event = { days = 1055 id = tibet.450 }
					#country_event = { days = 5 id = tibet.65 }
					#country_event = { days = 12 id = tibet.66 }
				}
				CHI = { country_event = { days = 700 id = tibet.602 } }
			}
			
			### Условные сторис
			if = {
				limit = {
					has_start_date < 1936.01.02
				}
				SOV = {
					country_event = { id = NWgeneric_stories.1 days = 839 }		#Кыршехирское землетрясение
				}
			}
			else_if = {
				limit = {
					has_start_date > 1936.1.2
					has_start_date < 1939.8.15
				}
				SOV = {
					country_event = { id = NWgeneric_stories.1 days = 39 }		#Землетрясение в Дикили
				}
			}
			
			### УСИЛЕНИЕ ДУЧЕ
			if = {
				limit = {
					is_historical_focus_on = yes
					ITA = { is_ai = yes }
					ETH = { is_ai = yes }
				}
				ITA = {
					random_owned_state = {
						limit = { OR = { state = 550 state = 559 } }
						create_unit = {
							division = "name = \"Divisione Coloniale\" division_template = \"Divisione Coloniale\" start_experience_factor = 0.5" 
							owner = PREV
						}
					}
					random_owned_state = {
						limit = { OR = { state = 550 state = 559 } }
						create_unit = {
							division = "name = \"Divisione Coloniale\" division_template = \"Divisione Coloniale\" start_experience_factor = 0.5" 
							owner = PREV
						}
					}
					random_owned_state = {
						limit = { OR = { state = 550 state = 559 } }
						create_unit = {
							division = "name = \"Divisione Coloniale\" division_template = \"Divisione Coloniale\" start_experience_factor = 0.5" 
							owner = PREV
						}
					}
					random_owned_state = {
						limit = { OR = { state = 550 state = 559 } }
						create_unit = {
							division = "name = \"Divisione Coloniale\" division_template = \"Divisione Coloniale\" start_experience_factor = 0.5" 
							owner = PREV
						}
					}
					random_owned_state = {
						limit = { OR = { state = 550 state = 559 } }
						create_unit = {
							division = "name = \"Divisione Coloniale\" division_template = \"Divisione Coloniale\" start_experience_factor = 0.5" 
							owner = PREV
						}
					}
					random_owned_state = {
						limit = { OR = { state = 550 state = 559 } }
						create_unit = {
							division = "name = \"Divisione Celere\" division_template = \"Divisione Celere\" start_experience_factor = 0.5" 
							owner = PREV
						}
					}
					random_owned_state = {
						limit = { OR = { state = 550 state = 559 } }
						create_unit = {
							division = "name = \"Divisione Celere\" division_template = \"Divisione Celere\" start_experience_factor = 0.5" 
							owner = PREV
						}
					}
				}
			}
			
			#Починка подчинения
			every_state = {
				limit = {
					OR = {
						AND = {
							NOT = { is_core_of = ENG }
							is_owned_by = ENG
						}
						AND = {
							NOT = { is_core_of = FRA }
							is_owned_by = FRA
						}
						AND = {
							NOT = { is_core_of = BPL }
							is_owned_by = BPL
						}
					}
				}
				set_compliance = 100
				set_resistance = 0
			}
		}
	}


	#ROOT is new controller #FROM is old controller #FROM.FROM is state ID
	on_state_control_changed = {
		effect = {
			#чечня - круто
			if = {
				limit = {
					FROM.FROM = { state = 966 }
					ROOT = { NOT = { original_tag = ICH } }
					FROM = {
						original_tag = ICH
						is_puppet = no
						is_subject = no
						NOT = { has_cosmetic_tag = ICH_Chechnya }
					}
				}
				FROM = { set_cosmetic_tag = ICH_Chechnya }
			}
			if = {
				limit = {
					FROM.FROM = { state = 966 }
					FROM = { NOT = { original_tag = ICH } }
					ROOT = {
						original_tag = ICH
						is_puppet = no
						is_subject = no
						has_cosmetic_tag = ICH_Chechnya
					}
				}
				ROOT = { drop_cosmetic_tag = yes }
			}
			
			#Небесные воины сошли на землю и обратили белых в бегство
			if = {
				limit = {
					ROOT = {
						tag = COG
						NOT = { has_country_flag = COG_no_state_flag }
					}
					FROM = { has_war_with = ROOT }
				}
				ROOT = {
					country_event = { id = cog.7 }
				}
			}
			
			#Разрушение дворца в Аддис-Абебе
			if = {
				limit = {
					FROM.FROM = { state = 271 }
					ROOT = {
						tag = ITA
						has_idea = ITA_gas_idea
					}
					FROM = {
						tag = ETH
						has_war_with = ROOT
					}
					NOT = { has_global_flag = ETH_destruction_of_palace }
				}
				FROM = { country_event = { id = NWethiopia.10 hours = 6 } }
			}
			
			#Снос чужого призывного пункта в стейте // генерик решения
			if = {
				limit = {
					FROM.FROM = { has_state_flag = has_recruiting_station_flag_@FROM }
				}
				FROM.FROM = {
					if = {
						limit = { check_variable = { recruiting_station_var_level > 0 } }
						if = {
							limit = { check_variable = { recruiting_station_var_level = 6 } }
							add_state_modifier = { modifier = { local_manpower = -1.0 } }
						}
						else_if = {
							limit = { check_variable = { recruiting_station_var_level = 5 } }
							add_state_modifier = { modifier = { local_manpower = -0.9 } }
						}
						else_if = {
							limit = { check_variable = { recruiting_station_var_level = 4 } }
							add_state_modifier = { modifier = { local_manpower = -0.8 } }
						}
						else_if = {
							limit = { check_variable = { recruiting_station_var_level = 3 } }
							add_state_modifier = { modifier = { local_manpower = -0.7 } }
						}
						else_if = {
							limit = { check_variable = { recruiting_station_var_level = 2 } }
							add_state_modifier = { modifier = { local_manpower = -0.6 } }
						}
						else_if = {
							limit = { check_variable = { recruiting_station_var_level = 1 } }
							add_state_modifier = { modifier = { local_manpower = -0.5 } }
						}
						clear_variable = recruiting_station_var_level
					}
					clr_state_flag = has_recruiting_station_flag_@FROM
				}
			}
			if = {
				limit = {
					has_global_flag = NW_TUR_NEW_FOCUS_TREE
					FROM.FROM = { is_on_continent = europe }
					ROOT = { has_focus_tree = nw_turkish_focus_new }
				}
				ROOT = { add_to_variable = { turkey_europe_controlled_state = 1 } }
			}
			if = {
				limit = {
					has_global_flag = NW_TUR_NEW_FOCUS_TREE
					FROM.FROM = { is_on_continent = europe }
					FROM = { has_focus_tree = nw_turkish_focus_new }
				}
				FROM = { add_to_variable = { turkey_europe_controlled_state = -1 } }
			}
			#Снос корки анархиста в стейте // генерик решения
			if = {
				limit = {
					FROM.FROM = {
						has_state_flag = is_core_of_anarchist_flag
						is_core_of = FROM
					}
				}
				FROM.FROM = {
					clr_state_flag = is_core_of_anarchist_flag
					remove_core_of = FROM
				}
			}
			#Снос народных банков в стейте // генерик решения
			if = {
				limit = {
					FROM.FROM = {
						has_state_flag = has_peoples_bank_flag
					}
				}
				if = {
					limit = { ROOT = { NOT = { has_completed_focus = peoples_bank_focus } } }
					FROM.FROM = {
						clr_state_flag = has_peoples_bank_flag
					}
				}
				else = {
					ROOT = { set_actual_peoples_bank_idea = yes }
				}
				FROM = { set_actual_peoples_bank_idea = yes }
			}
			#Подчинение для BPL
			if = {
				limit = {
					FROM.FROM = {
						OR = {
							state = 455
							state = 1053
							state = 1054
						}
						NOT = { is_core_of = ROOT }
					}
					ROOT = { tag = BPL }
				}
				FROM.FROM = { set_compliance = 80 }
			}
			
			
			### WONDER BLOCK ###
			
			# Колизей // Рим, Италия // 2
			if = {
				limit = { FROM.FROM = { has_state_flag = kolizeum_wonder_flag } }
				ROOT = { country_event = { id = TR.wonder.2 } }
			}
			# Мачу-Пикчу // Перу // 494
			if = {
				limit = { FROM.FROM = { has_state_flag = machu_pikchu_wonder_flag } }
				ROOT = { country_event = { id = TR.wonder.3 } }
			}
			# Петра // Иордания // 455
			if = {
				limit = { FROM.FROM = { has_state_flag = petra_wonder_flag } }
				ROOT = { country_event = { id = TR.wonder.4 } }
			}
			# Тадж-Махал // Агра, Индия // 437
			if = {
				limit = { FROM.FROM = { has_state_flag = taj_mahal_wonder_flag } }
				ROOT = { country_event = { id = TR.wonder.5 } }
			}
			# Статуя Христа-Искупителя // Рио-де-Жанейро, Бразилия // 500
			if = {
				limit = { FROM.FROM = { has_state_flag = cristos_redentor_wonder_flag } }
				ROOT = { country_event = { id = TR.wonder.6 } }
			}
			# Чичен-Ица // Юкатан, Мексика // 474
			if = {
				limit = { FROM.FROM = { has_state_flag = chichen_itza_wonder_flag } }
				ROOT = { country_event = { id = TR.wonder.7 } }
			}
			# Айя-София // Стамбул, Турция // 341
			if = {
				limit = { FROM.FROM = { has_state_flag = sobor_sofia_wonder_flag } }
				ROOT = { country_event = { id = TR.wonder.8 } }
			}
			# Афинский Акрополь // Афины, Греция // 1024
			if = {
				limit = { FROM.FROM = { has_state_flag = afin_acropol_wonder_flag } }
				ROOT = { country_event = { id = TR.wonder.9 } }
			}
			# Альгамбра // Гранада, Испания // 173
			if = {
				limit = { FROM.FROM = { has_state_flag = algambra_wonder_flag } }
				ROOT = { country_event = { id = TR.wonder.10 } }
			}
			# Ангкор // Ангкор, Камбоджа // 741
			if = {
				limit = { FROM.FROM = { has_state_flag = angkor_wonder_flag } }
				ROOT = { country_event = { id = TR.wonder.11 } }
			}
			# Моаи // Остров Пасхи, Чили // 933
			if = {
				limit = {
					NOT = { has_global_flag = magic_moai }
					FROM.FROM = { has_state_flag = moai_wonder_flag }
					ROOT = { NOT = { has_idea = moai_wonder } }
				}
				ROOT = { country_event = { id = TR.wonder.12 } }
			}
			# Детект владением моаи // Остров Пасхи, Чили // 933
			if = {
				limit = {
					has_global_flag = magic_moai
					FROM.FROM = { has_state_flag = moai_wonder_flag }
					ROOT = {
						NOT = { has_country_flag = moai_lord_wonder }
						NOT = {
							OR = {
								has_idea = moai_red_wonder
								has_idea = moai_blue_wonder
								has_idea = moai_green_wonder
								has_idea = moai_purp_wonder
							}
						}
					}
				}
				ROOT = { country_event = { id = TR.wonder.13 } }
			}
			# Московский Кремль // Москва, СССР // 219
			if = {
				limit = { FROM.FROM = { has_state_flag = kremlin_wonder_flag } }
				ROOT = { country_event = { id = TR.wonder.20 } }
			}
			# Нойшванштайн // Фюссен, Германия // 52
			if = {
				limit = { FROM.FROM = { has_state_flag = noishvanshtain_wonder_flag } }
				ROOT = { country_event = { id = TR.wonder.21 } }
			}
			# Пирамиды Гизы // Египет // 552
			if = {
				limit = { FROM.FROM = { has_state_flag = piramids_wonder_flag } }
				ROOT = { country_event = { id = TR.wonder.22 } }
			}
			# Статуя Свободы // Нью-Йорк, США // 358
			if = {
				limit = {
					FROM.FROM = { has_state_flag = statuya_liberty_wonder_flag }
					ROOT = {
						NOT = {
							has_idea = statuya_liberty_wonder
							has_idea = statuya_communism_wonder
							has_idea = statuya_monarchy_wonder
							has_idea = statuya_neutrality_wonder
							has_idea = statuya_trozkism_wonder
							has_idea = statuya_fascism_wonder
							has_idea = statuya_technocracy_wonder
							has_idea = statuya_anarchism_wonder
						}
					}
				}
				ROOT = { country_event = { id = TR.wonder.23 } }
			}
			# Стоунхендж // Уилтшир, Великобритания // 338
			if = {
				limit = { FROM.FROM = { has_state_flag = stonehenge_wonder_flag } }
				ROOT = { country_event = { id = TR.wonder.24 } }
			}
			# Томбукту // Мали // 556
			if = {
				limit = { FROM.FROM = { has_state_flag = tombuktu_wonder_flag } }
				ROOT = { country_event = { id = TR.wonder.25 } }
			}
			# Храм Киёмидзу-дэра // Киото, Япония // 531
			if = {
				limit = { FROM.FROM = { has_state_flag = temple_kiemidzu_dera_wonder_flag } }
				ROOT = { country_event = { id = TR.wonder.26 } }
			}
			# Эйфелева башня // Париж, Франция // 16
			if = {
				limit = { FROM.FROM = { has_state_flag = eiffel_tower_wonder_flag } }
				ROOT = { country_event = { id = TR.wonder.27 } }
			}
			#check controller of great china wall
			if = {
				limit = {
					FROM.FROM = {
						has_state_flag = great_wall_wonder_flag
						is_controlled_by = ROOT
					}
				}
				ROOT = {
					add_to_variable = { var = bonus_gw value = 1 }
					country_event = { id = TR.wonder.28 }
				}
				FROM = {
					subtract_from_variable = { var = bonus_gw value = 1 }
					country_event = { id = TR.wonder.28 }
				}
			}
		}
		#ROOT is new controller #FROM is old controller #FROM.FROM is state ID
	}
	
	on_government_change = {
		effect = {
			######### TROZKISM BLOCK #########
			if = {
				limit = { has_country_flag = is_trozkist_country_flag }
				clr_country_flag = is_trozkist_country_flag
				add_to_variable = { global.troz_threat_var = -1.5 }
				if = {
					limit = { has_cosmetic_tag = KMX_cosmetic }
					drop_cosmetic_tag = yes
				}
			}
			set_variable = { global.total_trozkist = 0 }
			every_country = {
				limit = {
					has_government = trozkism
					NOT = {
						has_country_leader = { name = "Nikolas Roerich" ruling_only = yes }
					}
				}
				add_to_variable = { global.total_trozkist = 1 }
				if = {
					limit = { NOT = { has_dynamic_modifier = { modifier = troz_threat_dyn } } }
					add_dynamic_modifier = { modifier = troz_threat_dyn }
				}
			}
			if = {
				limit = {
					has_government = trozkism
					NOT = {
						has_country_leader = { name = "Nikolas Roerich" ruling_only = yes }
					}
				}
				if = {
					limit = { NOT = { has_country_flag = is_trozkist_country_flag } }
					set_country_flag = is_trozkist_country_flag
				}
				if = {
					limit = { num_of_factories > 49 }
					add_to_variable = { global.troz_threat_var = 3 }
					log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): добавил 3 тронапряги как мажор"
				}
				else_if = {
					limit = { num_of_factories > 24 }
					add_to_variable = { global.troz_threat_var = 2 }
					log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): добавил 2 тронапряги как миддл"
				}
				else = {
					add_to_variable = { global.troz_threat_var = 1 }
					log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): добавил 1 тронапряги как минор)0"
				}
				set_var_for_troz_threat_dyn = yes
			}
			######### END TROZKISM BLOCK #########
			country_event = { id = TRpolitical.106 }
			#Габсы
			if = {
				limit = {
					NOT = { has_global_flag = WORLD_OF_SPLIT_FLAG }
					NOT = { has_country_flag = hhnbrg_flag }
					OR = {
						original_tag = CZE
						original_tag = AUS
						#AND = {
						#	original_tag = HUN	#Венгр и так монархист со старта
						#	HUN = { has_completed_focus = HUN_invite_the_habsburg_prince }
						#}
					}
					has_government = monarchy
				}
				if = {
					limit = {
						all_country = { NOT = { has_country_flag = hbbrg_flag } }
						NOT = {
							has_global_flag = THE_MOTHER_OF_ORDER_FLAG
							has_global_flag = WORLD_OF_SPLIT_FLAG
						}
					}
					country_event = { id = NWmonarchy.0 }
				}
				if = {
					limit = { any_other_country = { has_country_flag = hbbrg_flag } }
					set_country_flag = hbbrg_minor_flag
					random_country = {
						limit = { has_country_flag = hbbrg_flag }
						if = {
							limit = { has_government = fascism }
							set_autonomy = {
								target = ROOT
								autonomy_state = autonomy_reichsprotectorate
							}
						}
						if = {
							limit = { NOT = { has_government = fascism } }
							set_autonomy = {
								target = ROOT
								autonomy_state = autonomy_puppet
							}
						}
					}
				}
			}
			
			if = {
				limit = {
					tag = TUR
					has_government = fascism
					NOT = { has_country_flag = NWturkey70_flag }
				}
				TUR = {
					set_country_flag = NWturkey70_flag
					country_event = { id = NWturkey.69 days = 140 }
				}
			}
			
			if = {
				limit = {
					tag = USA
					has_government = trozkism
				}
				set_autonomy = {
					target = USA
					autonomy_state = autonomy_free
				}
				every_other_country = {
					limit = {
						has_war_with = ROOT
						is_subject = no
						OR = { is_faction_leader = yes is_in_faction = no }
					}
					white_peace = ROOT
				}
				if = {
					limit = {
						USA = {
							is_in_faction = yes
							NOT = { is_in_faction_with = KMX }
						}
					}
					USA = { leave_faction = yes }
				}
				if = {
					limit = { KMX = { is_faction_leader = yes } }
					USA = {
						add_ai_strategy = {
							type = alliance
							id = "KMX"
							value = 400
						}
					}
					USA = { KMX = { country_event = { id = generic.2 days = 0 } } }
				}
			}
			if = {
				limit = {
					tag = CAN
					has_government = trozkism
				}
				set_autonomy = {
					target = CAN
					autonomy_state = autonomy_free
				}
				every_other_country = {
					limit = {
						has_war_with = ROOT
						is_subject = no
						OR = { is_faction_leader = yes is_in_faction = no }
					}
					white_peace = ROOT
				}
				if = {
					limit = {
						CAN = {
							is_in_faction = yes
							NOT = { is_in_faction_with = KMX }
						}
					}
					CAN = { leave_faction = yes }
				}
				if = {
					limit = { KMX = { is_faction_leader = yes } }
					CAN = {
						add_ai_strategy = {
							type = alliance
							id = "KMX"
							value = 400
						}
					}
					CAN = { KMX = { country_event = { id = generic.2 days = 0 } } }
				}
			}
			if = {
				limit = {
					tag = BRA
					has_government = trozkism
				}
				set_autonomy = {
					target = BRA
					autonomy_state = autonomy_free
				}
				every_other_country = {
					limit = {
						has_war_with = ROOT
						is_subject = no
						OR = { is_faction_leader = yes is_in_faction = no }
					}
					white_peace = ROOT
				}
				if = {
					limit = {
						BRA = {
							is_in_faction = yes
							NOT = { is_in_faction_with = KMX }
						}
					}
					BRA = { leave_faction = yes }
				}
				if = {
					limit = { KMX = { is_faction_leader = yes } }
					BRA = {
						add_ai_strategy = {
							type = alliance
							id = "KMX"
							value = 400
						}
					}
					BRA = { KMX = { country_event = { id = generic.2 days = 0 } } }
				}
			}
			
			#ВБ стала троц и воюет с троц
			if = {
				limit = {
					tag = ENG
					has_government = trozkism
				}
				if = {
					limit = {
						ENG = {
							is_in_faction = yes
							NOT = { is_in_faction_with = KMX }
						}
					}
					ENG = { leave_faction = yes }
				}
				every_other_country = {
					limit = {
						has_war_with = ROOT
						is_subject = no
						OR = { is_faction_leader = yes is_in_faction = no }
					}
					white_peace = ROOT
				}
				if = {
					limit = { KMX = { is_faction_leader = yes } }
					ENG = {
						add_ai_strategy = {
							type = alliance
							id = "KMX"
							value = 400
						}
					}
					ENG = { KMX = { country_event = { id = generic.2 days = 0 } } }
				}
			}
			
			#Смена подидеологии в случае ошибочной генерации
			if = {
				limit = {
					has_government = neutrality
					NOT = {
						has_country_flag = authoritarian_democracy
						has_country_flag = militarism
					}
					NOT = {
						original_tag = GXC
						original_tag = YUN
						original_tag = SHX
						original_tag = XSM
						original_tag = SIK
						original_tag = SIH
						original_tag = XIK
						original_tag = SHA
						original_tag = TNG
						original_tag = NEA
					}
				}
				random_list = {
					25 = { set_country_leader_ideology = despotism }
					25 = { set_country_leader_ideology = oligarchism }
					25 = { set_country_leader_ideology = moderatism }
					25 = { set_country_leader_ideology = centrism }
				}
			}
			if = {
				limit = {
					has_government = neutrality
					has_country_flag = authoritarian_democracy
				}
				set_country_leader_ideology = authoritarian_democracy
				clr_country_flag = authoritarian_democracy
			}
			if = {
				limit = {
					has_government = neutrality
					OR = {
						has_country_flag = militarism
						OR = {
							original_tag = GXC
							original_tag = YUN
							original_tag = SHX
							original_tag = XSM
							original_tag = SIK
							original_tag = SIH
							original_tag = XIK
							original_tag = SHA
							original_tag = TNG
							original_tag = NEA
						}
					}
				}
				set_country_leader_ideology = militarism
				clr_country_flag = militarism
			}
			if = {
				limit = {
					has_government = monarchy
					has_country_flag = dual_monarchy
				}
				set_country_leader_ideology = dual_monarchy
				clr_country_flag = dual_monarchy
			}
			if = {
				limit = {
					has_government = monarchy
					has_country_flag = absolute_monarchy
				}
				set_country_leader_ideology = absolute_monarchy
				clr_country_flag = absolute_monarchy
			}
			if = {
				limit = {
					has_government = communism
					has_country_flag = socialist_stratocracy
				}
				set_country_leader_ideology = socialist_stratocracy
				clr_country_flag = socialist_stratocracy
			}
			if = {
				limit = {
					has_government = trozkism
					has_country_flag = left_communism
				}
				set_country_leader_ideology = left_communism
				clr_country_flag = left_communism
			}
			if = {
				limit = {
					has_government = trozkism
					has_country_flag = trozkism1
				}
				set_country_leader_ideology = trozkism1
				clr_country_flag = trozkism1
			}
			if = {
				limit = {
					has_government = fascism
					has_country_flag = fascism_corporatism
				}
				set_country_leader_ideology = fascism_corporatism
				clr_country_flag = fascism_corporatism
			}
			if = {
				limit = {
					has_government = fascism
					has_country_flag = nationalism_ideology
				}
				set_country_leader_ideology = nationalism_ideology
				clr_country_flag = nationalism_ideology
			}
			if = {
				limit = {
					has_government = fascism
					has_country_flag = nazism
				}
				set_country_leader_ideology = nazism
				clr_country_flag = nazism
			}
			if = {
				limit = {
					has_government = fascism
					has_country_flag = rexism
				}
				set_country_leader_ideology = rexism
				clr_country_flag = rexism
			}
			if = {
				limit = {
					has_government = fascism
					has_country_flag = integralism
				}
				set_country_leader_ideology = integralism
				clr_country_flag = integralism
			}
			
			
			#Фокус «Умиротворение Германии» // Автовыполнение у event_target:NW_france_scope
			if = {
				limit = {
					tag = GER
					has_government = democratic
				}
				if = {
					limit = {
						country_exists = FRA
						FRA = { NOT = { has_completed_focus = FRA_appeasement_of_germany } }
					}
					FRA = { complete_national_focus = FRA_appeasement_of_germany }
				}
			}
			if = {
				limit = {
					tag = GRE
					NOT = { has_government = fascism }
				}
				if = {
					limit = { has_idea = GRE_antiparliamentarism }
					remove_ideas = GRE_antiparliamentarism
				}
				if = {
					limit = { has_idea = GRE_right_parliament }
					remove_ideas = GRE_right_parliament
				}
			}
			if = {
				limit = {
					original_tag = PER
					has_dynamic_modifier = { modifier = PER_influence_of_clergy_dynamic_modifier }
				}
				set_opinion_with_clergy_var = yes
				set_influence_clergy_Value = yes
			}
			if = {
				limit = {
					has_idea = irregular_army
				}
				country_lock_all_division_template = yes
			}
			if = {
				limit = {
					NOT = { has_government = anarchism }
				}
				reset_anarchism_party_name = yes
			}
		}
	}
	
	
	#ROOT is subject FROM is previous overlord
	on_subject_free = {
		effect = {
			if = {
				limit = {
					tag = BPL
					has_cosmetic_tag = BPL_UK
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					tag = PAL
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					tag = JOR
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					tag = LEB
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					tag = SYR
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					tag = LKA
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					tag = NFL
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					tag = POL
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					tag = COG
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					tag = PER
					FROM = { original_tag = ENG }
				}
				every_country = {
					limit = { has_country_flag = PER_integration_south_azerbaijan_flag }
					clr_country_flag = PER_integration_south_azerbaijan_flag
				}
				if = {
					limit = {
						original_tag = PER
					}
					if = {
						limit = {
							country_exists = QAS
							NOT = { has_war_with = QAS }
							NOT = { has_country_flag = NWpersian_74_flag }
						}
						country_event = { id = NWpersian.74 hours = 6 }
					}
				}
			}
			if = {
				limit = {
					has_cosmetic_tag = BPL_technat_subject
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					has_cosmetic_tag = FIC_FRA
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					has_cosmetic_tag = HRE_subject_cosmetic
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					has_cosmetic_tag = HBBRG_use_subject
				}
				drop_cosmetic_tag = yes
			}
		}
	}
	
	
	#used when puppeting in a peace conference
	#ROOT = nation being puppeted, FROM = overlord
	on_puppet = {
		effect = {
			######### TROZKISM BLOCK #########
			if = {
				limit = { has_country_flag = is_trozkist_country_flag }
				clr_country_flag = is_trozkist_country_flag
				add_to_variable = { global.troz_threat_var = -1.5 }
			}
			set_variable = { global.total_trozkist = 0 }
			every_country = {
				limit = {
					has_government = trozkism
					NOT = {
						has_country_leader = { name = "Nikolas Roerich" ruling_only = yes }
					}
				}
				add_to_variable = { global.total_trozkist = 1 }
				if = {
					limit = { NOT = { has_dynamic_modifier = { modifier = troz_threat_dyn } } }
					add_dynamic_modifier = { modifier = troz_threat_dyn }
				}
			}
			if = {
				limit = {
					ROOT = {
						has_government = trozkism
						NOT = {
							has_country_leader = { name = "Nikolas Roerich" ruling_only = yes }
						}
					}
				}
				if = {
					limit = { NOT = { has_country_flag = is_trozkist_country_flag } }
					set_country_flag = is_trozkist_country_flag
				}
				if = {
					limit = { num_of_factories > 49 }
					add_to_variable = { global.troz_threat_var = 3 }
					log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): добавил 3 тронапряги как марионетка"
				}
				else_if = {
					limit = { num_of_factories > 24 }
					add_to_variable = { global.troz_threat_var = 2 }
					log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): добавил 2 тронапряги как марионетка"
				}
				else = {
					add_to_variable = { global.troz_threat_var = 1 }
					log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): добавил 1 тронапряги как марионетка"
				}
				set_var_for_troz_threat_dyn = yes
			}
			######### END TROZKISM BLOCK #########
			ROOT = { country_event = { id = TRpolitical.106 } }
			#Смена подидеологии в случае ошибочной генерации
			if = {
				limit = {
					has_government = trozkism
					NOT = { tag = TUR }
					NOT = {
						has_country_leader = { name = "Nikolas Roerich" ruling_only = yes }
					}
				}
				random_list = {
					50 = { set_country_leader_ideology = marxism1 }
					50 = { set_country_leader_ideology = trozkism1 }
				}
			}
			if = {
				limit = {
					has_government = neutrality
					NOT = { has_country_flag = authoritarian_democracy }
					NOT = { has_country_flag = militarism }
					NOT = {
						original_tag = GXC
						original_tag = YUN
						original_tag = SHX
						original_tag = XSM
						original_tag = SIK
						original_tag = SIH
						original_tag = XIK
						original_tag = SHA
						original_tag = TNG
						original_tag = NEA
					}
				}
				random_list = {
					25 = { set_country_leader_ideology = despotism }
					25 = { set_country_leader_ideology = oligarchism }
					25 = { set_country_leader_ideology = moderatism }
					25 = { set_country_leader_ideology = centrism }
				}
			}
			if = {
				limit = {
					has_government = neutrality
					has_country_flag = authoritarian_democracy
				}
				set_country_leader_ideology = authoritarian_democracy
			}
			if = {
				limit = {
					has_government = neutrality
					OR = {
						has_country_flag = militarism
						OR = {
							original_tag = GXC
							original_tag = YUN
							original_tag = SHX
							original_tag = XSM
							original_tag = SIK
							original_tag = SIH
							original_tag = XIK
							original_tag = SHA
							original_tag = TNG
							original_tag = NEA
						}
					}
				}
				set_country_leader_ideology = militarism
			}
			#Определение победителя // Конец ГВ либералов
			if = {
				limit = {
					OR = {
						has_global_flag = liberal_spanish_civil_war
						has_global_flag = haos_liberal_spanish_civil_war
					}
					NOT = {
						has_global_flag = THE_MOTHER_OF_ORDER_FLAG
						has_global_flag = WORLD_OF_SPLIT_FLAG
					}
					NOT = { has_global_flag = scw_over }
					ROOT = {
						OR = {
							tag = SPR
							tag = CAS
							tag = NAV
							tag = SEU
							tag = SPC
							tag = ANL
							tag = ARA
							tag = ASU
							tag = SNT
							tag = CAT
							tag = BAS
							tag = GLC
							tag = VLA
						}
					}
					FROM = {
						OR = {
							tag = SPR
							tag = CAS
							tag = NAV
							tag = SEU
							tag = SPC
							tag = ANL
							tag = ARA
							tag = ASU
							tag = SNT
							tag = CAT
							tag = BAS
							tag = GLC
							tag = VLA
						}
					}
				}
				ROOT = { country_event = { id = NWspain.50 hours = 6 } }
			}
			if = {
				limit = {
					tag = SYR
					has_cosmetic_tag = SYR_FRA
					FROM = {
						NOT = {
							original_tag = FRA
							original_tag = FRC
							original_tag = FRR
							original_tag = FRF
						}
					}
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					tag = LEB
					has_cosmetic_tag = LEB_FR
					FROM = {
						NOT = {
							original_tag = FRA
							original_tag = FRC
							original_tag = FRR
							original_tag = FRF
						}
					}
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					tag = LKA
					has_cosmetic_tag = LKA_ENG
					FROM = { original_tag = ENG }
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					tag = NFL
					has_cosmetic_tag = NFL_ENG
					FROM = { original_tag = ENG }
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					has_cosmetic_tag = BPL_technat_subject
					FROM = { NOT = { tag = BPL } }
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					has_cosmetic_tag = FIC_FRA
					FROM = { NOT = { tag = event_target:NW_france_scope } }
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					AND = {
						tag = FIC
						is_subject_of = event_target:NW_france_scope
					}
				}
				set_cosmetic_tag = FIC_FRA
			}
			if = {
				limit = {
					FROM = { has_cosmetic_tag = HRE_UNIFIED }
					NOT = { has_cosmetic_tag = HRE_subject_cosmetic }
				}
				set_cosmetic_tag = HRE_subject_cosmetic
			}
			if = {
				limit = {
					FROM = { has_cosmetic_tag = HBBRG_use_tag }
					NOT = { has_cosmetic_tag = HBBRG_use_subject }
					capital_scope = { is_on_continent = europe }
				}
				set_cosmetic_tag = HBBRG_use_subject
			}
		}
		#ROOT = nation being puppeted, FROM = overlord
	}
	
	
	
	#used when puppeting through the occupied territories menu during peace time (or when releasing from non-core but owned territory, f.e. Britain releasing Egypt)
	#ROOT = nation being released, FROM = overlord
	
	on_release_as_puppet = {
		effect = {
			ROOT = { country_event = { id = TRpolitical.106 } }
			#Смена подидеологии в случае ошибочной генерации
			if = {
				limit = {
					has_government = trozkism
					NOT = { tag = TUR }
					NOT = {
						has_country_leader = { name = "Nikolas Roerich" ruling_only = yes }
					}
				}
				random_list = {
					50 = { set_country_leader_ideology = marxism1 }
					50 = { set_country_leader_ideology = trozkism1 }
				}
			}
			if = {
				limit = {
					has_government = neutrality
					NOT = { has_country_flag = authoritarian_democracy }
					NOT = { has_country_flag = militarism }
					NOT = {
						original_tag = GXC
						original_tag = YUN
						original_tag = SHX
						original_tag = XSM
						original_tag = SIK
						original_tag = SIH
						original_tag = XIK
						original_tag = SHA
						original_tag = TNG
						original_tag = NEA
						original_tag = NGX
						original_tag = YUL
					}
				}
				random_list = {
					25 = { set_country_leader_ideology = despotism }
					25 = { set_country_leader_ideology = oligarchism }
					25 = { set_country_leader_ideology = moderatism }
					25 = { set_country_leader_ideology = centrism }
				}
			}
			if = {
				limit = {
					has_government = neutrality
					has_country_flag = authoritarian_democracy
				}
				set_country_leader_ideology = authoritarian_democracy
			}
			if = {
				limit = {
					has_government = neutrality
					OR = {
						has_country_flag = militarism
						OR = {
							original_tag = GXC
							original_tag = YUN
							original_tag = SHX
							original_tag = XSM
							original_tag = SIK
							original_tag = SIH
							original_tag = XIK
							original_tag = SHA
							original_tag = TNG
							original_tag = NEA
							original_tag = NGX
							original_tag = YUL
						}
					}
				}
				set_country_leader_ideology = militarism
			}
			if = {
				limit = {
					tag = COG
					NOT = {
						FROM = {
							original_tag = BEL
						}
					}
				}
				COG = {
					drop_cosmetic_tag = yes
				}
			}
			if = {
				limit = {
					tag = MAN
					FROM = {
						original_tag = JAP
					}
				}
				MAN = {
					set_cosmetic_tag = MAN_kwantung_army
					create_country_leader = {
						name = "Kenkichi Ueda"
						picture = "gfx/leaders/JAP/Portrait_Japan_Kenkichi_Ueda.dds"
						expire = "1965.1.1"
						ideology = absolute_monarchy
						traits = {
						   
   					    }
					}
					create_country_leader = {
						name = "Kenkichi Ueda"
						picture = "gfx/leaders/JAP/Portrait_Japan_Kenkichi_Ueda.dds"
						expire = "1965.1.1"
						ideology = fascism_ideology
						traits = {
						   
   					    }
					}
				}
			}
			if = {
				limit = {
					has_cosmetic_tag = FIC_FRA
					FROM = { NOT = { tag = event_target:NW_france_scope } }
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					AND = {
						tag = FIC
						is_subject_of = event_target:NW_france_scope
					}
				}
				set_cosmetic_tag = FIC_FRA
			}
		}
	}
	
	#FROM is war target
	on_declare_war = {
		effect = {
			#YUG agr
			if = {
				limit = {
					ROOT = { tag = YUG }
					YUG = { has_country_flag = no_barter_flag }
					FROM = { has_country_flag = anti_YUG_flag }
				}
				FROM = {
					every_other_country = {
						limit = {
							has_country_flag = anti_YUG_flag
							NOT = { tag = FROM }
						}
						country_event = { id = NWmonarchy.97 days = 1 }
					}
				}
			}
			#YUG def
			if = {
				limit = {
					FROM = { tag = YUG }
					YUG = { has_country_flag = no_barter_flag }
					ROOT = { has_country_flag = anti_YUG_flag }
				}
				ROOT = {
					every_other_country = {
						limit = {
							has_country_flag = anti_YUG_flag
							NOT = { tag = ROOT }
						}
						country_event = { id = NWmonarchy.97 days = 1 }
					}
				}
			}
			#ARA states and troops
			if = {
				limit = {
					OR = {
						AND = {
							FROM = {
								OR = {
									tag = SPR
									tag = SPA
								}
								OR = {
									owns_state = 169
									owns_state = 173
								}
							}
							ROOT = { tag = ARA }
						}
						AND = {
							FROM = { tag = ARA }
							ROOT = {
								OR = {
									tag = SPR
									tag = SPA
								}
								OR = {
									owns_state = 169
									owns_state = 173
								}
							}
						}
					}
					ARA = { has_country_flag = ARA_call_to_anarchists_andalusia_flag }
				}
				ARA = {
					transfer_state = 169
					transfer_state = 173
					division_template = {
						name = "Anarchists Brigada N2"
						priority = 1
						is_locked = no
						regiments = {
							infantry = { x = 0 y = 0 }
							infantry = { x = 0 y = 1 }
							infantry = { x = 0 y = 2 }
							infantry = { x = 1 y = 0 }
							infantry = { x = 1 y = 1 }
							infantry = { x = 1 y = 2 }
						}
					}
					169 = {
						create_unit = {
							division = "name = \"1. Anarchists Brigada\" division_template = \"Anarchists Brigada N2\" start_experience_factor = 0.5" 
							owner = ARA
						}
					}
					173 = {
						create_unit = {
							division = "name = \"2. Anarchists Brigada\" division_template = \"Anarchists Brigada N2\" start_experience_factor = 0.5" 
							owner = ARA
						}
					}
					clr_country_flag = ARA_call_to_anarchists_andalusia_flag
				}
			}
			
			#Анархо-Испанская ГВ (1vs1vs1)
			#if = {
			#	limit = {
			#		FROM = { tag = SPR }
			#		ROOT = { tag = ARA }
			#		has_global_flag = spanish_civil_war
			#		NOT = { has_global_flag = scw_over }
			#		SPR = { has_war_with = SPA }
			#	}
			#	ROOT = {
			#		news_event = { id = trworldnews.68 hours = 6 }
			#	}
			#}
			
			# Потеря Грецией нацдуха в случае британской агрессии
			if = { 
				limit = { 
					ROOT = { original_tag = ENG } 
					FROM = { original_tag = GRE }
					GRE = { has_idea = GRE_idea_pro_british_king }
				} 
				GRE = { 
					swap_ideas = {
						remove_idea = GRE_idea_pro_british_king
						add_idea = GRE_idea_georg_ii
					}
				}
			}
			#Сброс нац. духов ТроФранка
			if = {
				limit = {
					FROM = {
						OR = {
							tag = ITA
							tag = ENG
							tag = SPR
							tag = SIA
							tag = INS
							tag = RAJ
						}
						has_idea = trozkism_influence6
					}
					ROOT = {
						tag = event_target:NW_france_scope
						has_government = trozkism
					}
				}
				FROM = {
					remove_ideas = trozkism_influence6
				}
			}
			
			#FRA // Фокус "Укрепление Сопротивления в Северной Франции"
			if = {
				limit = {
					OR = {
						AND = {
							FROM = {
								OR = {
									tag = ITA
									tag = GER
								}
							}
							ROOT = {
								tag = FRA
								has_country_flag = FRA_strengthening_resistance_in_northern_france_flag
							}
						}
						AND = {
							FROM = {
								tag = FRA
								has_country_flag = FRA_strengthening_resistance_in_northern_france_flag
							}
							ROOT = {
								OR = {
									tag = ITA
									tag = GER
								}
							}
						}
					}
				}
				FRA = {
					clr_country_flag = FRA_strengthening_resistance_in_northern_france_flag
				}
				every_state = {
					limit = {
						is_core_of = FRA
						controller = {
							OR = {
								tag = ITA
								tag = GER
								is_in_faction_with = ITA
								is_in_faction_with = GER
								is_subject_of = GER
								is_subject_of = ITA
							}
						}
					}
					FRA = { transfer_state = PREV }
				}
			}
			#Франко ГВ
			if = {
				limit = {
					FROM = {
						OR = {
							tag = FRA
							tag = FRC
							tag = FRF
							tag = FRR
						}
					}
					ROOT = {
						OR = {
							tag = FRA
							tag = FRC
							tag = FRF
							tag = FRR
						}
					}
				}
				FROM = { add_ideas = FRA_civil_war }
				ROOT = { add_ideas = FRA_civil_war }
			}
			#Польша на два фронта
			if = {
				limit = {
					has_global_flag = sov_yes_pact
					NOT = { GER = { is_in_faction_with = SOV } }
					POL = {
						is_in_faction = yes
						is_faction_leader = no
					}
					OR = {
						POL = { has_war_with = GER }
						POL = { has_war_with = SOV }
					}
					OR = {
						AND = {
							FROM = { OR = { tag = SOV tag = GER } }
							ROOT = { tag = POL }
						}
						AND = {
							FROM = { tag = POL }
							ROOT = { OR = { tag = SOV tag = GER } }
						}
					}
				}
				FROM = { set_country_flag = POL_truce }
				ROOT = { set_country_flag = POL_truce }
				
				random_country = {
					limit = {
						is_in_faction_with = POL
						is_faction_leader = yes
					}
					if = {
						limit = { NOT = { has_war_with = FROM has_war_with = ROOT } }
						country_event = { id = poland.war.42 }
					}
					else = {
						FROM = { clr_country_flag = POL_truce }
						ROOT = { clr_country_flag = POL_truce }
					}
				}
			}
			#Привлечение германских советников // PER
			if = {
				limit = {
					PER = {
						has_completed_focus = PER_involvement_german_advisers
						NOT = { has_country_flag = PER_involvement_german_advisers_once_flag }
					}
					OR = {
						AND = {
							FROM = { tag = GER }
							ROOT = { tag = PER }
						}
						AND = {
							FROM = { tag = PER }
							ROOT = { tag = GER }
						}
					}
				}
				PER = {
					set_country_flag = PER_involvement_german_advisers_once_flag
					every_owned_state = {
						remove_building = {
							type = infrastructure
							level = 1
						}
					}
				}
			}
			#Цейлон риск голода
			if = {
				limit = {
					OR = {
						ROOT = { tag = LKA }
						FROM = { tag = LKA }
					}
					LKA = { has_idea = LKA_idea_food_risk }
				}
				LKA = { country_event = { id = lka.46 days = 60 } }
			}
			#Последствия советско-персидского договора
			if = {
				limit = {
					FROM = {
						OR = {
							tag = SOV
							tag = PER
						}
					}
					ROOT = {
						OR = {
							tag = SOV
							tag = PER
						}
					}
					PER = { has_idea = PER_soviet_persian_treaty }
				}
				PER = {
					remove_ideas = PER_soviet_persian_treaty
					add_timed_idea = { idea = PER_soviet_persian_treaty_2 days = 180 }
				}
			}
			#Отсчет Белого мира для Американо-либерийской
			if = {
				limit = {
					FROM = {
						OR = {
							tag = LIB
							tag = USA
						}
					}
					ROOT = {
						OR = {
							tag = LIB
							tag = USA
						}
					}
					USA = { has_country_flag = nw_liberia_27a_flag }
				}
				LIB = {
					set_country_flag = { flag = LIB_usa_white_peace_flag days = 120 }
				}
			}
			#Разрыв экономических связей // AFG
			if = {
				limit = {
					AFG = {
						has_idea = AFG_addiction_foreign_trade
						NOT = { has_idea = AFG_failed_trade_system }
					}
					OR = {
						FROM = {
							tag = AFG
						}
						ROOT = {
							OR = {
								tag = SOV
								if = {
									limit = {
										NOT = { country_exists = RAJ }
										439 = { is_controlled_by = ENG }
									}
									tag = ENG
								}
								else = { tag = RAJ }
							}
						}
					}
					OR = {
						FROM = {
							OR = {
								tag = SOV
								if = {
									limit = {
										NOT = { country_exists = RAJ }
										439 = { is_controlled_by = ENG }
									}
									tag = ENG
								}
								else = { tag = RAJ }
							}
						}
						ROOT = {
							tag = AFG
						}
					}
				}
				AFG = { country_event = { id = afg.4 days = 1 } }
			}
			FROM = {
				set_country_flag = is_war_target_of_@ROOT
				log = "[GetDateText]: [This.GetName] ([This.GetTag]): is war target of [Root.GetName] ([Root.GetTag])"
			}
			#Страна в гражданской войне
			if = {
				limit = {
					if = {
						limit = { SPR_scw_in_progress = yes }
						FROM = { is_literally_spain = no }
						ROOT = { is_literally_spain = no }
					}
					FROM = {
						has_civil_war = yes
						NOT = { has_idea = generic_civil_war }
					}
					ROOT = {
						has_civil_war = yes
						NOT = { has_idea = generic_civil_war }
					}
				}
				FROM = { add_ideas = generic_civil_war }
				ROOT = { add_ideas = generic_civil_war }
			}
			#Страна в гражданской войне
			if = {
				limit = {
					FROM = {
						OR = {
							tag = SOV
							tag = PER
						}
					}
					ROOT = {
						OR = {
							tag = SOV
							tag = PER
						}
					}
					PER = {
						OR = {
							has_country_flag = PER_organize_an_uprising_in_tajikistan_complete_flag
							has_country_flag = PER_organize_an_uprising_in_azerbaijan_complete_flag
						}
					}
				}
				if = {
					limit = { PER = { has_country_flag = PER_organize_an_uprising_in_tajikistan_complete_flag } }
					PER = {
						clr_country_flag = PER_organize_an_uprising_in_tajikistan_complete_flag
						load_oob = "PER_soviet_rise_taj"
					}
				}
				if = {
					limit = { PER = { has_country_flag = PER_organize_an_uprising_in_azerbaijan_complete_flag } }
					PER = {
						clr_country_flag = PER_organize_an_uprising_in_azerbaijan_complete_flag
						load_oob = "PER_soviet_rise_azr"
					}
				}
			}
			### TRO THREAT ###
			if = {
				limit = {
					OR = {
						AND = {
							ROOT = { has_government = trozkism }
							FROM = { NOT = { has_government = trozkism } }
						}
						AND = {
							FROM = { has_government = trozkism }
							ROOT = { NOT = { has_government = trozkism } }
						}
					}
				}
				set_temp_variable = { troz_threat_temp_var = 1 }
				add_to_variable = { global.troz_threat_var = troz_threat_temp_var }
				custom_effect_tooltip = troz_threat_tt1
				set_var_for_troz_threat_dyn = yes
				log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): добавил 1 тронапряги из-за нападения на [From.GetName] ([From.GetTag])"
			}
			if = {
				limit = {
					ROOT = { has_government = trozkism }
					FROM = { has_government = trozkism }
				}
				set_temp_variable = { troz_threat_temp_var = -5 }
				add_to_variable = { global.troz_threat_var = troz_threat_temp_var }
				custom_effect_tooltip = troz_threat_tt2
				set_var_for_troz_threat_dyn = yes
				log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): добавил -5 тронапряги из-за нападения на [From.GetName] ([From.GetTag])"
			}
			if = {
				limit = {
					has_idea = BPL_anti_semitic_riots
					FROM = { tag = BPL }
				}
				swap_ideas = {
					remove_idea = BPL_anti_semitic_riots
					add_idea = BPL_anti_semitic_riots_2
				}
				hidden_effect = {
					if = {
						limit = { FROM = { NOT = { has_country_flag = NWpalestine_81_flag } } }
						FROM = {
							set_country_flag = NWpalestine_81_flag
							country_event = { id = NWpalestine.81 }
						}
					}
				}
			}
			# barbarossa
			if = { 
				limit = {
					is_ai = yes 
					is_in_faction_with = GER
					is_neighbor_of = SOV
					FROM = { tag = SOV } 
				}

				hidden_effect = { 
					set_country_flag = { flag = NW_barbarossa_blitz value = 1 days = 30 }

					SOV = { set_country_flag = { flag = NW_barbarossa_defensive value = 1 days = 270 } }
				}
			}
			# Для снятия договора СССР с Прибалтикой
			if = {
				limit = {
					FROM = {
						OR = {
							original_tag = SOV
							has_idea = SOV_baltic_agreement_idea
						}
					}
					ROOT = {
						OR = {
							original_tag = SOV
							has_idea = SOV_baltic_agreement_idea
						}
					}
				}
				ROOT = {
					remove_ideas = SOV_baltic_agreement_idea
					clr_country_flag = SOV_baltic_falsification_ready
				}
				FROM = {
					remove_ideas = SOV_baltic_agreement_idea
					clr_country_flag = SOV_baltic_falsification_ready
				}
			}
			#PRC call in PRC_north_western_government
			if = {
				limit = {
					NOT = { original_tag = GXC }
					is_chinese_warlord = yes
					is_subject = no
					PRC = {
						has_country_flag = PRC_north_western_government_flag
						is_faction_leader = yes
					}
					FROM = {
						OR = {
							original_tag = CHI
							original_tag = JAP
						}
					}
				}
				PRC = {
					country_event = { id = tr_japan.8 hours = 3 }
				}
			}
			### ИРРЕГУЛЯРКА ###
			if = {
				limit = {
					FROM = {
						OR = {
							has_idea = irregular_army
							has_idea = partial_regular_army
						}
					}
				}
				set_temp_variable = { peoples_militia_var_temp = FROM.peoples_militia_var }
				if = {
					limit = { check_variable = { peoples_militia_var_temp < 10 } }
					add_to_temp_variable = { peoples_militia_var_temp = 1 }
				}
				else_if = {
					limit = {
						check_variable = { peoples_militia_var_temp > 9 }
						check_variable = { peoples_militia_var_temp < 20 }
					}
					add_to_temp_variable = { peoples_militia_var_temp = 2 }
				}
				else = {
					multiply_temp_variable = { peoples_militia_var_temp = 1.1 }
				}
				round_temp_variable = peoples_militia_var_temp
				set_temp_variable = { peoples_militia_var_temp1 = peoples_militia_var_temp }
				set_temp_variable = { peoples_militia_var_temp2 = peoples_militia_var_temp }
				multiply_temp_variable = { peoples_militia_var_temp = 0.5 }
				round_temp_variable = peoples_militia_var_temp
				subtract_from_temp_variable = { peoples_militia_var_temp1 = peoples_militia_var_temp }
				add_to_temp_variable = { peoples_militia_var_temp2 = peoples_militia_var_temp }
				round_temp_variable = peoples_militia_var_temp1
				round_temp_variable = peoples_militia_var_temp2
				if = {
					limit = { check_variable = { peoples_militia_var_temp1 = peoples_militia_var_temp2 } }
					add_to_temp_variable = { peoples_militia_var_temp2 = 1 }
				}
				custom_effect_tooltip = irregular_army_tt2
			}
		} #FROM is war target
	}
	
	# ROOT is capitulated country, FROM is winner
	on_capitulation = {
		effect = {
			#End of SCW
			#Классическая ГВ Испании
			if = {
				limit = {
					FROM = {
						tag = SPA
					}
					ROOT = {
						tag = SPR
					}
				}
				#FROM = { add_timed_idea = { idea = SPA_recovering_from_civil_war days = 1825 } }
				
				FROM = {
					if = {
						limit = {
							ARA = {
								has_war_with = SPA
								is_puppet_of = SPR
							}
						}
						FROM = {
							annex_country = {
								target = ARA
								transfer_troops = no
							}
						}
					}
					if = {
						limit = {
							BAS = {
								has_war_with = SPA
								is_puppet_of = SPR
							}
						}
						FROM = {
							annex_country = {
								target = BAS
								transfer_troops = no
							}
						}
					}
					if = {
						limit = {
							CAT = {
								has_war_with = SPA
								is_puppet_of = SPR
							}
						}
						FROM = {
							annex_country = {
								target = CAT
								transfer_troops = no
							}
						}
					}
					if = {
						limit = {
							GLC = {
								has_war_with = SPA
								is_puppet_of = SPR
							}
						}
						FROM = {
							annex_country = {
								target = GLC
								transfer_troops = no
							}
						}
					}
					if = {
						limit = {
							ASU = {
								has_war_with = SPA
								is_puppet_of = SPR
							}
						}
						FROM = {
							annex_country = {
								target = ASU
								transfer_troops = no
							}
						}
					}
					if = {
						limit = {
							SNT = {
								has_war_with = SPA
								is_puppet_of = SPR
							}
						}
						FROM = {
							annex_country = {
								target = SNT
								transfer_troops = no
							}
						}
					}
					if = {
						limit = {
							VLA = {
								has_war_with = SPA
								is_puppet_of = SPR
							}
						}
						FROM = {
							annex_country = {
								target = VLA
								transfer_troops = no
							}
						}
					}
				
					annex_country = {
						target = ROOT
						transfer_troops = no
					}
				}
			}
			if = {
				limit = {
					FROM = {
						OR = {
							tag = SPR
							tag = SPA
						}
					}
					ROOT = {
						OR = {
							tag = SPR
							tag = SPA
						}
					}
				}
				FROM = {
					#add_timed_idea = { idea = SPA_recovering_from_civil_war days = 1825 }
					annex_country = {
						target = ROOT
						transfer_troops = no
					}
				}
				every_state = {
					limit = { is_core_of = ROOT }
					remove_core_of = ROOT
				}
				every_state = {
					limit = { is_claimed_by = ROOT }
					remove_claim_by = ROOT
				}
			}
			
			if = {
				limit = {
					ROOT = { tag = ASU }
				}
				ROOT = {
					174 = { remove_core_of = ASU }
					drop_cosmetic_tag = yes
				}
			}
			if = {
				limit = {
					ROOT = { tag = SNT }
				}
				ROOT = {
					drop_cosmetic_tag = yes
				}
			}
			if = {
				limit = {
					ROOT = { tag = DZH }
				}
				ROOT = {
				    create_country_leader = {
					    name = "Dalelkhan Sugirbayev"
					    desc = "POLITICS_DALELKHAN_SUGIRBAYEV_DESC"
					    picture = "gfx/leaders/DZH/Portrait_Dalelkhan_Sugirbayev.dds"
					    expire = "1965.1.1"
					    ideology = stalinism
					    traits = {
					    }
				    }

				    create_country_leader = {
				    	name = "Ospan Batyr"
					    desc = "POLITICS_OSPAN_BATYR_DESC"
					    picture = "gfx/leaders/DZH/Portrait_Ospan_Batyr.dds"
					    expire = "1965.1.1"
					    ideology = despotism
					    traits = {					        
					    }
				    }
					
					drop_cosmetic_tag = yes
				}
			}
			if = {
				limit = {
					ROOT = { tag = KUM }
				}
				ROOT = {
				    760 = { remove_core_of = KUM }
					drop_cosmetic_tag = yes
				}
			}
			if = {
				limit = {
					ROOT = { tag = KAS }
				}
				ROOT = {
				    619 = { remove_core_of = KAS }
					1122 = { remove_core_of = KAS }
					drop_cosmetic_tag = yes
				}
			}
			
			#Святое войско уничтожило источник Сатаны на земле белых
			if = {
				limit = {
					FROM = {
						tag = COG
						NOT = { has_country_flag = COG_no_capitulation_flag }
					}
				}
				FROM = {
					country_event = { id = cog.9 }
				}
			}
			
			#Образование Эллинского государства
			if = {
				limit = {
					ROOT = {
						OR = {
							tag = GRE
							tag = CRE
						}
					}
					GER = { has_war_with = ROOT }
					has_global_flag = ger_form_hel_flag
					NOT = { has_global_flag = ger_form_hel_end_flag }
				}
				GER = { country_event = { id = NWgreece_hel.1 days = 1 } }
			}
			if = {
				limit = {
					ROOT = {
						OR = {
							tag = GRE
							tag = CRE
						}
					}
					GER = {
						has_war_with = ROOT
						has_government = fascism
					}
					ITA = {
						has_government = fascism
						is_in_faction_with = GER
					}
					NOT = { has_global_flag = ger_form_hel_flag }
					NOT = { has_global_flag = ger_form_hel_end_flag }
				}
				random_country = {
					limit = {
						NOT = { tag = ROOT }
						has_war_with = ROOT
					}
					country_event = { id = NWgreece_hel.999 }
				}
			}
			
			#Падение марионеточной Греции
			if = {
				limit = {
					ROOT = { tag = HEL }
					FROM = {
						OR = {
							OR = {
								tag = GRE
								is_in_faction_with = GRE
							}
							OR = {
								tag = CRE
								is_in_faction_with = CRE
							}
						}
					}
					NOT = { has_global_flag = ger_form_hel_flag }
					NOT = { has_global_flag = ger_form_hel_end_flag }
				}
				FROM = { country_event = { id = NWgreece_hel.7 days = 1 } }
			}
			
			#Сопротивление Греции
			if = {
				limit = {
					ROOT = {
						OR = {
							tag = GRE
							AND = {
								tag = CRE
								NOT = {
									has_government = communism
									has_government = trozkism
								}
							}
						}
					}
				}
				if = {
					limit = {
						FROM = {
							NOT = {
								tag = HEL
								has_idea = HEL_illegitimate_government
							}
						}
					}
					FROM = {
						set_variable = { resistance_score = 48 }
						country_event = { id = NWgreece_hel.8 days = 1 }
					}
				}
			}
			
			#ГВ Габс/Гогены
			if = {
				limit = {
					has_civil_war = no
					OR = {
						AND = {
							ROOT = { tag = event_target:NW_hbbrg_scope }
							FROM = { tag = event_target:NW_hhnbrg_scope }
						}
						AND = {
							ROOT = { tag = event_target:NW_hhnbrg_scope }
							FROM = { tag = event_target:NW_hbbrg_scope }
						}
					}
				}
				FROM = {
					annex_country = {
						target = ROOT
						transfer_troops = no
					}
				}
				every_state = {
					limit = { is_core_of = ROOT }
					add_core_of = FROM
				}
			}
			
			#ГВ IRQ
			if = {
				limit = {
					IRQ = { has_civil_war = yes }
					ROOT = {
						original_tag = IRQ
						NOT = { has_government = communism }
						is_subject_of = ENG
					}
				}
				ENG = { country_event = { id = NWiraq.8 } }
			}
			
			#ЖОР BPL = PAL/ISR
			if = {
				limit = {
					ROOT = {
						OR = {
							original_tag = PAL
							original_tag = ISR
						}
					}
					OR = {
						BPL = { is_subject_of = FROM }
						FROM = {
							OR = {
								original_tag = BPL
								is_in_faction_with = BPL
								is_subject_of = BPL
							}
						}
					}
				}
				BPL = {
					annex_country = {
						target = ROOT
						transfer_troops = yes
					}
				}
				every_state = {
					limit = { is_core_of = ROOT }
					add_core_of = BPL
					remove_core_of = ROOT
				}
			}
			
			#ГВ GER-передача флота
			if = {
				limit = {
					FROM = {
						tag = event_target:fascist_germany_civil_war
					}
					ROOT = {
						tag = GER
					}
				}
				GER = {
					transfer_navy = {
						target = event_target:fascist_germany_civil_war
					}
				}
			}	
            if = {
				limit = {
					FROM = {
						tag = GER
					}
					ROOT = {
						tag = event_target:fascist_germany_civil_war
					}
				}
				event_target:fascist_germany_civil_war = {
					transfer_navy = {
						target = GER
					}
				}
			}
			#ГВ-Китай
			if = {
				limit = {
					FROM = {
						is_chinese_warlord = yes
					}
					ROOT = {
						tag = CHI
					}
				}
				FROM = {
					load_focus_tree = china_nationalist_focus
					set_cosmetic_tag = CHI_warlord_leader
				}
				every_state = {
					limit = { is_core_of = ROOT }
					add_core_of = FROM
				}
				every_state = {
					limit = { is_core_of = ROOT }
					remove_core_of = ROOT
				}
			}
			if = {
				limit = {
					has_civil_war = no
					ROOT = { is_chinese_warlord = yes }
					FROM = { tag = CHI }
				}
				FROM = {
					annex_country = {
						target = ROOT
						transfer_troops = no
					}
				}
				every_state = {
					limit = { is_core_of = ROOT }
					remove_core_of = ROOT
				}
			}
			#ГВ-Франция
            if = {
				limit = {
					FROM = {
						tag = FRA
					}
					ROOT = {
						tag = FRC
					}
				}
				FRC = {
					transfer_navy = {
						target = FRA
					}
				}
			}
            if = {
				limit = {
					FROM = {
						tag = FRC
					}
					ROOT = {
						tag = FRA
					}
				}
				FRA = {
					transfer_navy = {
						target = FRC
					}
				}
			}			
			if = {
				limit = {
					FROM = {
						tag = FRA
					}
					ROOT = {
						tag = FRF
					}
				}
				FRF = {
					transfer_navy = {
						target = FRA
					}
				}
			}
            if = {
				limit = {
					FROM = {
						tag = FRF
					}
					ROOT = {
						tag = FRA
					}
				}
				FRA = {
					transfer_navy = {
						target = FRF
					}
				}
			}
			
			### TRO THREAT ###
			if = {
				limit = {
					ROOT = {
						has_government = trozkism
						NOT = {
							has_country_leader = { name = "Nikolas Roerich" ruling_only = yes }
						}
					}
				}
				add_to_variable = { global.troz_threat_var = -1 }
				set_var_for_troz_threat_dyn = yes
				log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): добавил -1 тронапряги капитуляцией"
			}
			
			#### Слёт соглашения стран Прибалтики с СССР при капитуляции последней
			if = {
				limit = {
					ROOT = { original_tag = SOV }
					any_country = {
						has_idea = SOV_baltic_agreement_idea
					}
				}
				every_country = {
					limit = { has_idea = SOV_baltic_agreement_idea }
					remove_ideas = SOV_baltic_agreement_idea
					clr_country_flag = SOV_baltic_falsification_ready
				}
			}
			
			#Чек Ялты
			if = {
				limit = {
					has_global_flag = had_yalta_conference
					ROOT = {
						tag = GER
						has_government = fascism
					}
				}
				every_country = {
					limit = {
						has_country_flag = JAP_yalta_conference_flag
					}
					clr_country_flag = JAP_yalta_conference_flag
					if = {
						limit = { NOT = { has_war_with = JAP } }
						activate_mission = generic_JAP_start_prepare_mission
					}
				}
			}
			# ROOT is capitulated country, FROM is winner
		}
	}
	
	on_uncapitulation = {
		effect = {
			# Уборка фабрик и доков вне карты после возвращения домой
			if = {
				limit = {
					original_tag = ROOT
					check_variable = { var = industrialists_counter@ROOT value > 0 }
				}
				set_variable = { var_null@ROOT = 0 }
				subtract_from_variable = { var_null@ROOT = industrialists_counter@ROOT }
				add_offsite_building = { type = arms_factory level = var_null@ROOT }
				add_offsite_building = { type = industrial_complex level = var_null@ROOT }
				set_variable = { industrialists_counter@ROOT = 0 }
			}
			if = {
				limit = {
					original_tag = ROOT
					check_variable = { var = obtain_dockyard_counter@ROOT value > 0 }
				}
				set_variable = { var_null@ROOT = 0 }
				multiply_variable = { industrialists_counter@ROOT = 2 }				
				subtract_from_variable = { var_null@ROOT = obtain_dockyard_counter@ROOT }
				add_offsite_building = { type = dockyard level = var_null@ROOT }
				set_variable = { obtain_dockyard_counter@ROOT = 0 }
			}
		}
	}
	
	#ROOT is winner #FROM gets annexed - For civil wars on_civil_war_end is also fired
	on_annex = {
		effect = {
			#SPR - ARA
			if = {
				limit = {
					FROM = { tag = SPR }
					ROOT = {
						OR = {
							tag = ARA
							tag = CAT
						}
					}
				}
				ARA = {
					every_state = {
						limit = {
							is_claimed_by = ARA
							NOT = { is_fully_controlled_by = ARA }
						}
						remove_core_of = ARA
						remove_claim_by = ARA
					}
				}
				if = {
					limit = { GLC = { exists = yes } }
					ARA = {
						every_state = {
							limit = { is_fully_controlled_by = GLC }
							add_claim_by = ARA
							add_core_of = ARA
						}
					}
				}
				if = {
					limit = { BAS = { exists = yes } }
					ARA = {
						every_state = {
							limit = { is_fully_controlled_by = BAS }
							add_claim_by = ARA
							add_core_of = ARA
						}
					}
				}
				if = {
					limit = { ASU = { exists = yes } }
					ARA = {
						every_state = {
							limit = { is_fully_controlled_by = ASU }
							add_claim_by = ARA
							add_core_of = ARA
						}
					}
				}
				if = {
					limit = { SNT = { exists = yes } }
					ARA = {
						every_state = {
							limit = { is_fully_controlled_by = SNT }
							add_claim_by = ARA
							add_core_of = ARA
						}
					}
				}
				if = {
					limit = { CAT = { exists = yes } }
					CAT = {
						every_state = {
							limit = {
								is_claimed_by = CAT
								NOT = { is_fully_controlled_by = CAT }
							}
							remove_core_of = CAT
							remove_claim_by = CAT
						}
					}
				}
				SPR = {
					every_state = {
						limit = {
							is_core_of = SPR
						}
						remove_core_of = SPR
						remove_claim_by = SPR
					}
				}
			}
			
			
			#Пульсар побед лагерей // правые
			if = {
				limit = {
					has_global_flag = liberal_spanish_civil_war
					NOT = { has_global_flag = scw_over }
					NOT = {
						has_global_flag = THE_MOTHER_OF_ORDER_FLAG
						has_global_flag = WORLD_OF_SPLIT_FLAG
					}
					FROM = {
						OR = {
							tag = SPC
							tag = ANL
							tag = ARA
						}
					}
				}
				ROOT = { country_event = { id = NWspain.51 hours = 6 } }
			}
			
			#Пульсар побед лагерей // левые
			if = {
				limit = {
					has_global_flag = liberal_spanish_civil_war
					NOT = { has_global_flag = scw_over }
					FROM = {
						OR = {
							tag = CAS
							tag = NAV
							tag = SEU
						}
					}
				}
				ROOT = { country_event = { id = NWspain.52 hours = 6 } }
			}
			
			#Снятие клеймов и корок у проигравшего минора Испании
			if = {
				limit = {
					OR = {
						has_global_flag = liberal_spanish_civil_war
						has_global_flag = haos_liberal_spanish_civil_war
					}
					NOT = {
						has_global_flag = THE_MOTHER_OF_ORDER_FLAG
						has_global_flag = WORLD_OF_SPLIT_FLAG
					}
					NOT = { has_global_flag = scw_over }
					FROM = {
						OR = {
							tag = SPR
							tag = CAS
							tag = NAV
							tag = SEU
							tag = SPC
							tag = ANL
							tag = ARA
							tag = ASU
							tag = SNT
							tag = CAT
							tag = BAS
							tag = GLC
							tag = VLA
						}
					}
				}
				every_state = {
					limit = { is_claimed_by = FROM }
					remove_claim_by = FROM
				}
				every_state = {
					limit = { is_core_of = FROM }
					remove_core_of = FROM
				}
			}
			
			#Жор каталонии-марионетки // Либеральная ГВ
			if = {
				limit = {
					has_global_flag = liberal_spanish_civil_war
					NOT = { has_global_flag = scw_over }
					FROM = { tag = SPR }
				}
				if = {
					limit = {
						country_exists = CAT
						CAT = {
							is_ai = yes
							OR = {
								has_war_with = CAS
								has_war_with = NAV
								has_war_with = SEU
								has_war_with = SPC
								has_war_with = ANL
								has_war_with = ARA
								has_war_with = ROOT
							}
						}
					}
					ROOT = {
						annex_country = {
							target = CAT
							transfer_troops = no
						}
					}
				}
				else_if = {
					limit = {
						country_exists = CAT
						CAT = {
							NOT = {
								has_war_with = CAS
								has_war_with = NAV
								has_war_with = SEU
								has_war_with = SPC
								has_war_with = ANL
								has_war_with = ARA
								has_war_with = ROOT
							}
						}
					}
					ROOT = {
						add_ai_strategy = {
							type = antagonize
							id = "CAT"
							value = 500
						}
						add_ai_strategy = {
							type = conquer
							id = "CAT" 
							value = 500
						}
					}
				}
			}
			
			#Определение победителя // Конец ГВ либералов
			if = {
				limit = {
					OR = {
						has_global_flag = liberal_spanish_civil_war
						has_global_flag = haos_liberal_spanish_civil_war
					}
					NOT = {
						has_global_flag = THE_MOTHER_OF_ORDER_FLAG
						has_global_flag = WORLD_OF_SPLIT_FLAG
					}
					NOT = { has_global_flag = scw_over }
					ROOT = {
						OR = {
							tag = SPR
							tag = CAS
							tag = NAV
							tag = SEU
							tag = SPC
							tag = ANL
							tag = ARA
							tag = ASU
							tag = SNT
							tag = CAT
							tag = BAS
							tag = GLC
							tag = VLA
						}
					}
					FROM = {
						OR = {
							tag = SPR
							tag = CAS
							tag = NAV
							tag = SEU
							tag = SPC
							tag = ANL
							tag = ARA
							tag = ASU
							tag = SNT
							tag = CAT
							tag = BAS
							tag = GLC
							tag = VLA
						}
					}
				}
				ROOT = { country_event = { id = NWspain.50 hours = 6 } }
			}
			
			#SIK теряет нац.духа после аннексии Уйгуров
			if = {
				limit = {
					FROM = { tag = KAS }
					ROOT = { tag = SIK }
				}
				ROOT = { remove_ideas = SIK_nationalism }
			}
			
			if = {
				limit = {
					FROM = { tag = KAS }
					ROOT = { tag = SIK }
				}
				ROOT = { load_focus_tree = china_warlord_focus }
			}
			
			if = {
				limit = {
					FROM = {
						has_idea = SOV_baltic_agreement_idea
					}
				}
				remove_ideas = SOV_baltic_agreement_idea
				clr_country_flag = SOV_baltic_falsification_ready
			}
		}
	}
	
	on_release_as_free = {
		effect = {
			ROOT = { country_event = { id = TRpolitical.106 } }
			if = {
				limit = {
					tag = POL
					POL = { has_cosmetic_tag = POL_SOV }
				}
				POL = { drop_cosmetic_tag = yes }
			}
			if = {
				limit = {
					tag = COG
					FROM = {
						NOT = {
							original_tag = BEL
						}
					}
				}
				COG = {
					drop_cosmetic_tag = yes
				}
			}
			if = {
				limit = {
					tag = MAN
					FROM = {
						NOT = {
							original_tag = JAP
						}
					}
				}
				MAN = {
					drop_cosmetic_tag = yes
				}
			}
			if = {
				limit = {
					tag = SYR
					has_cosmetic_tag = SYR_FRA
					FROM = {
						NOT = {
							original_tag = FRA
							original_tag = FRC
							original_tag = FRR
							original_tag = FRF
						}
					}
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					tag = LEB
					has_cosmetic_tag = LEB_FR
					FROM = {
						NOT = {
							original_tag = FRA
							original_tag = FRC
							original_tag = FRR
							original_tag = FRF
						}
					}
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					tag = LKA
					has_cosmetic_tag = LKA_ENG
					FROM = { NOT = { original_tag = ENG } }
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					tag = BPL
					has_cosmetic_tag = BPL_UK
					FROM = { NOT = { original_tag = ENG } }
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					tag = NFL
					has_cosmetic_tag = NFL_ENG
					FROM = { NOT = { original_tag = ENG } }
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					has_cosmetic_tag = BPL_technat_subject
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					has_cosmetic_tag = FIC_FRA
				}
				drop_cosmetic_tag = yes
			}
		}
	}
	
	#ROOT is winner #FROM is loser
	on_peaceconference_ended = {
		effect = {
			FROM = { country_event = { id = TRpolitical.106 } }
			#France
			if = {
				limit = {
					FROM = { tag = FRA }
					ROOT = { tag = FRC }
				}
				every_state = {
					limit = { is_claimed_by = FROM }
					remove_claim_by = FROM
				}
				every_state = {
					limit = { is_core_of = FROM }
					remove_core_of = FROM
				}
				every_country = {
					limit = {
						has_war_with = ROOT
						NOT = { original_tag = ROOT }
						NOT = { original_tag = FROM }
						is_subject = no
						OR = { is_faction_leader = yes is_in_faction = no }
					}
					white_peace = ROOT
				}
				ROOT = {
					remove_ideas = FRA_civil_war
					news_event = { id = trworldnews.80 hours = 6 }
					clear_global_event_target = NW_france_scope
					save_global_event_target_as = NW_france_scope
				}
			}
			if = {
				limit = {
					FROM = { tag = FRC }
					ROOT = { tag = FRA }
				}
				every_state = {
					limit = { is_claimed_by = FROM }
					remove_claim_by = FROM
				}
				every_state = {
					limit = { is_core_of = FROM }
					remove_core_of = FROM
				}
				ROOT = {
					remove_ideas = FRA_civil_war
					news_event = { id = trworldnews.81 hours = 6 }
					clear_global_event_target = NW_france_scope
					save_global_event_target_as = NW_france_scope
				}
			}
			if = {
				limit = {
					FROM = {
						original_tag = FRC
						NOT = { tag = FRC }
						OR = { tag = D01 tag = D02 tag = D03 tag = D04 tag = D05 tag = D06 tag = D07 tag = D08 tag = D09 tag = D10 tag = D11 tag = D12 tag = D13 tag = D14 tag = D15 tag = D16 tag = D17 tag = D18 tag = D19 tag = D20 tag = D21 tag = D22 tag = D23 tag = D24 tag = D25 tag = D26 tag = D27 tag = D28 tag = D29 tag = D30 tag = D31 tag = D32 tag = D33 tag = D34 tag = D35 tag = D36 tag = D37 tag = D38 tag = D39 tag = D40 tag = D41 tag = D42 tag = D43 tag = D44 tag = D45 tag = D46 tag = D47 tag = D48 tag = D49 tag = D50 }
						#has_government = communism
					}
					ROOT = { OR = { tag = FRA tag = FRC } }
				}
				every_state = {
					limit = { is_claimed_by = FROM }
					remove_claim_by = FROM
				}
				every_state = {
					limit = { is_core_of = FROM }
					remove_core_of = FROM
				}
				ROOT = {
					annex_country = {
						target = FROM
						transfer_troops = no
					}
				}
			}
			
			#Кагуляры // FRF
			if = {
				limit = {
					FROM = { tag = FRA }
					ROOT = { tag = FRF }
				}
				every_state = {
					limit = { is_claimed_by = FROM }
					remove_claim_by = FROM
				}
				every_state = {
					limit = { is_core_of = FROM }
					remove_core_of = FROM
				}
				ROOT = {
					remove_ideas = FRA_civil_war
					news_event = { id = trworldnews.88 hours = 6 }
					clear_global_event_target = NW_france_scope
					save_global_event_target_as = NW_france_scope
				}
			}
			if = {
				limit = {
					FROM = { tag = FRF }
					ROOT = { tag = FRA }
				}
				every_state = {
					limit = { is_claimed_by = FROM }
					remove_claim_by = FROM
				}
				every_state = {
					limit = { is_core_of = FROM }
					remove_core_of = FROM
				}
				every_country = {
					limit = {
						has_war_with = ROOT
						NOT = { original_tag = ROOT }
						NOT = { original_tag = FROM }
						is_subject = no
						OR = { is_faction_leader = yes is_in_faction = no }
					}
					white_peace = ROOT
				}
				ROOT = {
					remove_ideas = FRA_civil_war
					news_event = { id = trworldnews.80 hours = 6 }
					clear_global_event_target = NW_france_scope
					save_global_event_target_as = NW_france_scope
				}
			}
			
			
			
			if = {
				limit = {
					FROM = { tag = POL }
					ROOT = { tag = event_target:NW_hhnbrg_scope }
				}
				event_target:NW_hhnbrg_scope = {
					delete_unit_template_and_units = {
						division_template = "Polish volunteers"
					}
				}
			}
			if = {
				limit = {
					FROM = {
						tag = SYR
						has_cosmetic_tag = SYR_FRA
					}
					ROOT = {
						NOT = {
							original_tag = FRA
							original_tag = FRC
							original_tag = FRR
							original_tag = FRF
						}
					}
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					FROM = {
						tag = LEB
						has_cosmetic_tag = LEB_FR
					}
					ROOT = {
						NOT = {
							original_tag = FRA
							original_tag = FRC
							original_tag = FRR
							original_tag = FRF
						}
					}
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					FROM = {
						tag = LKA
						has_cosmetic_tag = LKA_ENG
					}
					ROOT = { NOT = { original_tag = ENG } }
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					FROM = {
						tag = NFL
						has_cosmetic_tag = NFL_ENG
					}
					ROOT = { NOT = { original_tag = ENG } }
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					FROM = { has_cosmetic_tag = BPL_technat_subject }
					ROOT = { NOT = { tag = BPL } }
				}
				drop_cosmetic_tag = yes
			}
			#Костыль для советско-финской
			if = {
				limit = {
					FROM = {
						OR = {
							tag = SOV
							tag = FIN
						}
					}
					ROOT = {
						OR = {
							tag = SOV
							tag = FIN
						}
					}
					SOV = { has_country_flag = soviet_finland_war_flag }
				}
				SOV = { clr_country_flag = soviet_finland_war_flag }
				FIN = { set_rule = { can_join_factions = yes } }
			}
			#Дуче жрет ETH
			if = {
				limit = {
					ROOT = {
						tag = ITA
						is_ai = yes
					}
					FROM = { tag = ETH }
				}
				ROOT = {
					annex_country = {
						target = FROM
						transfer_troops = no
					}
				}
			}
			#Жор США
			if = {
				limit = {
					ROOT = { tag = USA }
					FROM = { tag = CSA }
				}
				ROOT = {
					annex_country = {
						target = FROM
						transfer_troops = no
					}
				}
			}
			if = {
				limit = {
					ROOT = { tag = CSA }
					FROM = { tag = USA }
				}
				ROOT = {
					annex_country = {
						target = FROM
						transfer_troops = no
					}
				}
			}
			#ЖОР BPL = PAL/ISR
			if = {
				limit = {
					FROM = {
						OR = {
							original_tag = PAL
							original_tag = ISR
						}
					}
					OR = {
						BPL = { is_subject_of = ROOT }
						ROOT = {
							OR = {
								original_tag = BPL
								is_in_faction_with = BPL
								is_subject_of = BPL
							}
						}
					}
				}
				BPL = {
					annex_country = {
						target = FROM
						transfer_troops = yes
					}
				}
				every_state = {
					limit = { is_core_of = FROM }
					add_core_of = BPL
					remove_core_of = FROM
				}
			}
			#ЖОР 72 стейта GER = POL/CZE
			if = {
				limit = {
					FROM = {
						OR = {
							original_tag = POL
							original_tag = CZE
						}
					}
					72 = {
						owner = {
							OR = {
								original_tag = POL
								original_tag = CZE
							}
						}
					}
				}
				937 = { owner = { transfer_state = 72 } }
			}
			#Нормальная Ялта
			if = {
				limit = {
					FROM = {
						tag = GER
						GER = { has_government = fascism }
					}
					ROOT = {
						OR = {
							tag = SOV
							is_in_faction_with = SOV
							tag = ENG
							is_in_faction_with = ENG
							tag = FRA
							is_in_faction_with = FRA
						}
					}
				}
				if = {
					limit = {
						ROOT = {
							OR = {
								tag = ENG
								is_in_faction_with = ENG
								tag = FRA
								is_in_faction_with = FRA
							}
							OR = {
								has_government = neutrality
								has_government = democratic
							}
						}
					}
					every_state = {
						limit = {
							is_core_of = WGR
							is_core_of = FROM
							#is_owned_by = FROM
						}
						WGR = { transfer_state = PREV }
					}
				}
				if = {
					limit = {
						ROOT = {
							OR = {
								tag = SOV
								is_in_faction_with = SOV
							}
							OR = {
								has_government = communism
								has_government = trozkism
							}
						}
					}
					every_state = {
						limit = {
							is_core_of = DDR
							is_core_of = FROM
							#is_owned_by = FROM
						}
						DDR = { transfer_state = PREV }
					}
					if = {
						limit = {
							POL = {
								OR = {
									has_government = communism
									has_government = trozkism
								}
							}
						}
						every_state = {
							limit = {
								OR = {
									is_core_of = POL
									state = 800
									state = 803
								}
								OR = {
									is_owned_by = DDR
									is_core_of = FROM
								}
							}
							add_core_of = POL
							POL = { transfer_state = PREV }
						}
						if = {
							limit = { 85 = { OR = { controller = { OR = { is_in_faction_with = POL } } owner = { OR = { is_in_faction_with = POL } } } } }
							POL = { transfer_state = 85 }
							85 = { add_core_of = POL }
						}
						if = {
							limit = { 774 = { OR = { controller = { OR = { is_in_faction_with = POL } } owner = { OR = { is_in_faction_with = POL } } } } }
							POL = { transfer_state = 774 }
							774 = { add_core_of = POL }
						}
						if = {
							limit = { 798 = { OR = { controller = { OR = { is_in_faction_with = POL } } owner = { OR = { is_in_faction_with = POL } } } } }
							POL = { transfer_state = 798 }
							798 = { add_core_of = POL }
						}
						if = {
							limit = { 837 = { OR = { controller = { OR = { is_in_faction_with = POL } } owner = { OR = { is_in_faction_with = POL } } } } }
							POL = { transfer_state = 837 }
							837 = { add_core_of = POL }
						}
						if = {
							limit = { 908 = { OR = { controller = { OR = { is_in_faction_with = POL } } owner = { OR = { is_in_faction_with = POL } } } } }
							POL = { transfer_state = 908 }
							908 = { add_core_of = POL }
						}
						every_state = {
							limit = {
								is_core_of = POL
								is_owned_by = SOV
								NOT = { is_core_of = SOV }
							}
							remove_core_of = POL
							add_core_of = SOV
						}
					}
				}
			}
			#CHI annex PRC after cgw
			if = {
				limit = {
					FROM = {
						tag = PRC
						has_country_flag = PRC_north_western_government_flag
					}
					ROOT = {
						OR = {
							tag = CHI
							tag = JAP
						}
					}
					CHI = { is_in_faction_with = JAP }
				}
				PRC = { clr_country_flag = PRC_north_western_government_flag }
				CHI = {
					annex_country = {
						target = PRC
						transfer_troops = yes
					}
				}
			}
		}
	} #ROOT is winner #FROM is loser
	
	
	#FROM is country getting invited.
	on_offer_join_faction = {
		effect = {
			if = {
				limit = {
					OR = {
						original_tag = FRA
						original_tag = FRC
					}
					FROM = {
						has_idea = BEL_flemish_walloon_conflict 
					}
				}
				FROM = {
					country_event = { id = NWbelgium.6 days = 1 }
				}
			}
			
		}
	}
	
	#FROM is faction leader on join faction requests. THIS DOES NOT FIRE ON ADD_TO_FACTION EFFECT! USE ON_OFFER_JOIN_FACTION!
	on_join_faction = {
		effect = {
			
		}
	}
	
	
	#ROOT is subject FROM is overlord
	on_subject_autonomy_level_change = {
		effect = {
			if = {
				limit = {
					tag = COG
					has_autonomy_state = autonomy_puppet
					FROM = { original_tag = BEL }
				}
				set_cosmetic_tag = COG_colony
			}
			if = {
				limit = {
					tag = COG
					has_autonomy_state = autonomy_dominion
					FROM = { original_tag = BEL }
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					has_cosmetic_tag = HRE_subject_cosmetic
					NOT = { is_subject_of = event_target:NW_hbbrg_scope }
				}
				ROOT = { drop_cosmetic_tag = yes }
			}
			if = {
				limit = {
					FROM = { has_cosmetic_tag = HRE_UNIFIED }
					ROOT = { NOT = { has_cosmetic_tag = HRE_subject_cosmetic } }
				}
				ROOT = { set_cosmetic_tag = HRE_subject_cosmetic }
			}
			if = {
				limit = {
					has_cosmetic_tag = HBBRG_use_subject
					NOT = { is_subject_of = event_target:NW_hbbrg_scope }
				}
				ROOT = { drop_cosmetic_tag = yes }
			}
			if = {
				limit = {
					FROM = { has_cosmetic_tag = HBBRG_use_tag }
					ROOT = {
						NOT = { has_cosmetic_tag = HBBRG_use_subject }
						capital_scope = { is_on_continent = europe }
					}
				}
				ROOT = { set_cosmetic_tag = HBBRG_use_subject }
			}
		}
	}
	
	#ROOT is winner #FROM gets annexed - This will also fire on_annex
	on_civil_war_end = {
		effect = {
			#Антибританские протесты в Тегеране
			if = {
				limit = {
					original_tag = PER
					has_government = neutrality
					has_country_flag = PER_NWpersian_3a_flag
					FROM = {
						has_government = fascism
					}
				}
				country_event = { id = NWpersian.27 days = 14 }
			}
			if = {
				limit = {
					original_tag = PER
					country_exists = KHU
					NOT = { has_country_flag = arabistan_flag }
				}
				if = {
					limit = { KHU = { is_in_faction = yes } }
					KHU = { leave_faction = yes }
				}
				country_event = { id = NWpersian.67 days = 1 }
			}
			if = {
				limit = {
					original_tag = PER
				}
				if = {
					limit = {
						country_exists = QAS
						ROOT = { NOT = { has_war_with = QAS } }
						NOT = { has_country_flag = NWpersian_74_flag }
					}
					country_event = { id = NWpersian.74 hours = 6 }
				}
			}
			#Исламисты победили в Иранской гражданской войне
			if = {
				limit = {
					original_tag = PER
					has_government = fascism
				}
				news_event = { id = trworldnews.95 hours = 6 }
			}
			#Реформисты победили в Иранской гражданской войне
			if = {
				limit = {
					original_tag = PER
					NOT = { has_government = fascism }
					FROM = { has_government = fascism }
				}
				news_event = { id = trworldnews.96 hours = 6 }
			}
			#Свержение императора
			if = {
				limit = {
					original_tag = ETH
					has_government = anarchism
				}
				country_event = { id = NWethiopia.101 hours = 6 }
			}
			#Боеспособность армии // Либерия
			if = {
				limit = {
					original_tag = LIB
					has_government = fascism
				}
				country_event = { id = nw_liberia.21 hours = 3 }
			}
			#Панчей-лама занял место регента // TIB
			if = {
				limit = {
					original_tag = TIB
					has_completed_focus = TIB_chinese_army
					country_exists = CHI
					NOT = { has_global_flag = TIB_panchen_lama_died }
				}
				country_event = { id = tibet.61 }
			}
			#Комми в Сикане слились. Тибет идет в демократию
			if = {
				limit = {
					original_tag = XIK
					has_country_flag = TIB_communist_uprising_of_tibetans_flag
					NOT = { has_government = communism }
					TIB = { NOT = { has_completed_focus = TIB_request_support_from_kuomintang } }
				}
				TIB = { country_event = { id = tibet.580 hours = 3 } }
			}
		}
		#ROOT is winner #FROM gets annexed - This will also fire on_annex
	}
	
	on_monthly = {
		effect = {
			if = {
				limit = {
					has_completed_focus = private_tribunals_focus
					NOT = { has_country_flag = { flag = fabricate_goal_against_process_flag value > 0 } }
				}
				clear_global_event_target = fabricate_goal_against_target_@ROOT
				random_neighbor_country = {
					limit = {
						NOT = { has_war_with = ROOT }
						NOT = {
							ROOT = {
								has_wargoal_against = PREV
							}
						}
					}
					save_global_event_target_as = fabricate_goal_against_target_@ROOT
					log = "[GetDateText]: [This.GetName] ([This.GetTag]): Новая цель судов [Root.GetName] ([Root.GetTag])"
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = trade_weapons
						option = DEFAULT
					}
					check_variable = { global.total_infantry_weapons > 0 }
				}
				SAI = {
					log = "[GetDateText]: [This.GetName] ([This.GetTag]): РАСЧЕТ ПЕХОТКИ ЧЕРНОГО РЫНКА: [?global.total_infantry_weapons]"
					set_temp_variable = { inflation_rifles = global.total_infantry_weapons }
					divide_temp_variable = { inflation_rifles = 10 }
					subtract_from_variable = { global.total_infantry_weapons = inflation_rifles }
					round_variable = global.total_infantry_weapons
				}
			}
		}
	}
	
	on_monthly_FRF = {
		effect = {
			if = {
				limit = {
					has_game_rule = {
						rule = trade_weapons
						option = DEFAULT
					}
					check_variable = { global.total_infantry_weapons > 0 }
					has_idea = FRF_use_global_market_idea
				}
				set_temp_variable = { inflation_rifles_for_fra = inflation_rifles }
				divide_temp_variable = { inflation_rifles_for_fra = 10 }
				round_temp_variable = inflation_rifles_for_fra
				add_equipment_to_stockpile = {
					type = infantry_equipment
					amount = inflation_rifles_for_fra
				}
				log = "[GetDateText]: [This.GetName] ([This.GetTag]): ПОЛУЧИЛ ПЕХОТКИ С ЧЕРНОГО РЫНКА: [?inflation_rifles_for_fra]"
			}
		}
	}

	on_weekly = {
		effect = {
			#if = {
			#	limit = {
			#		has_country_flag = timer_timer_flag
			#		country_exists = ROOT
			#	}
			#	log = "[GetDateText]: [This.GetName] ([This.GetTag]): Новая неделя"
			#}
			#else_if = {
			#	limit = {
			#		any_country = {
			#			has_country_flag = timer_timer_flag
			#			NOT = { country_exists = THIS }
			#		}
			#	}
			#	every_country = { clr_country_flag = timer_timer_flag }
			#	random_country = { set_country_flag = timer_timer_flag }
			#	log = "[GetDateText]: [This.GetName] ([This.GetTag]): Теперь крикун"
			#}
			
			#Голод // Нацдух ETH / LIB
			if = {
				limit = {
					OR = {
						has_idea = ETH_hunger
						has_idea = LIB_hunger
					}
				}
				every_owned_state = {
					limit = { is_core_of = ROOT }
					add_manpower = -5000
				}
				log = "[GetDateText]: [This.GetName] ([This.GetTag]): минус 5000 менпавера"
			}
			#ETH_ethiopism_trait_1500 // Еженедельный прирост населения: §R-1500§!
			if = {
				limit = {
					has_idea = ETH_ethiopism
				}
				random_owned_state = {
					add_manpower = -1500
				}
				log = "[GetDateText]: [This.GetName] ([This.GetTag]): минус 1500 менпавера"
			}
			#ETH_ethiopism_trait_1000 // Еженедельный прирост населения: §R-1000§!
			if = {
				limit = {
					OR = {
						has_idea = ETH_ethiopism_2
						has_idea = ETH_american_blacks_3
					}
				}
				random_owned_state = {
					add_manpower = -1000
				}
				log = "[GetDateText]: [This.GetName] ([This.GetTag]): минус 1000 менпавера"
			}
			#ETH_american_blacks_trait_1000 // Еженедельный прирост населения: §G1000§!
			if = {
				limit = {
					OR = {
						has_idea = ETH_ethiopism_3
						has_idea = ETH_american_blacks_2
					}
				}
				random_owned_state = {
					add_manpower = 1000
				}
				log = "[GetDateText]: [This.GetName] ([This.GetTag]): плус 1000 менпавера"
			}
			#ETH_american_blacks_trait_1500 // Еженедельный прирост населения: §G1500§!
			if = {
				limit = {
					has_idea = ETH_american_blacks
				}
				random_owned_state = {
					add_manpower = 1500
				}
				log = "[GetDateText]: [This.GetName] ([This.GetTag]): плус 1500 менпавера"
			}
			#Нац.дух на слонов
			if = {
				limit = {
					OR = {
						has_idea = LIB_elephants
						has_idea = ETH_elephants
						has_idea = ETH_elephants_2
						has_idea = ETH_elephants_3
						has_idea = ETH_elephants_4
						has_idea = ETH_elephants_5
					}
				}
				set_temp_variable = { total_elephant_equipment = ETH_elephants_trait_var }
				set_temp_variable = { num_elephant_states = 0 }
				every_controlled_state = {
					limit = { has_state_flag = elephant_spawn_state_flag }
					add_to_temp_variable = { num_elephant_states = 1 }
				}
				multiply_temp_variable = { total_elephant_equipment = num_elephant_states }
				add_equipment_to_stockpile = {
					type = elephant_equipment
					amount = total_elephant_equipment
				}
				log = "[GetDateText]: [This.GetName] ([This.GetTag]): плус [?total_elephant_equipment] слонов"
			}
			#административная эффективность // anarchism
			if = {
				limit = {
					has_variable = administrative_efficiency_var_total
					has_country_flag = generic_attracting_public_attention_to_our_company_flag
				}
				add_to_variable = { administrative_efficiency_var_total = 0.015 }
			}
			if = {
				limit = {
					has_government = anarchism
				}
				set_var_generic_anarchism_tendency = yes
			}
			#call_for_international_cooperation // generic anarchism
			if = {
				limit = {
					has_country_flag = call_for_international_cooperation_flag_2
				}
				add_named_threat = { threat = -0.15 name = call_for_international_cooperation }
				log = "[GetDateText]: [This.GetName] ([This.GetTag]): минус 0.15 напряги"
			}
			#AI_DIVISION_LIMITER_DYNAMIC
			if = {
				limit = {
					has_game_rule = { rule = ai_division_limiter_status option = AI_DIVISION_LIMITER_DYNAMIC }
				}
				set_variable = { ai_upper_limit = num_of_factories }
				multiply_variable = { ai_upper_limit = 1.15 }
				if = {
					limit = { is_major = yes }
					multiply_variable = { ai_upper_limit = 1.15 }
				}
				if = {
					limit = { has_war = yes }
					multiply_variable = { ai_upper_limit = 1.2 }
				}
				if = {
					limit = { threat > 0.74 }
					multiply_variable = { ai_upper_limit = 1.05 }
				}
				round_variable = ai_upper_limit
			}
			#operative_slot_idea_dyn
			if = {
				limit = {
					has_intelligence_agency = yes
					NOT = { has_game_rule = { rule = num_of_operative_slot_status option = PER_0 } }
				}
				if = {
					limit = { NOT = { has_dynamic_modifier = { modifier = operative_slot_idea_dyn } } }
					add_dynamic_modifier = { modifier = operative_slot_idea_dyn }
				}
				set_temp_variable = { operative_slot_temp = num_of_factories }
				divide_temp_variable = { operative_slot_temp = global.global_setup_operative }
				set_variable = { operative_slot_var = operative_slot_temp }
				round_variable = operative_slot_var
				if = {
					limit = {
						NOT = { has_game_rule = { rule = num_of_maximum_operative_status option = DEFAULT } }
						check_variable = { operative_slot_var > global.global_setup_maximum_operative }
					}
					set_variable = { operative_slot_var = global.global_setup_maximum_operative }
				}
			}
		}
	}
	
	on_daily = {
		effect = {
			#volunteer_only
			if = {
				limit = { has_idea = volunteer_only }
				if = {
					limit = { NOT = { has_dynamic_modifier = { modifier = volunteer_only_dyn } } }
					add_dynamic_modifier = { modifier = volunteer_only_dyn }
				}
				set_variable = { volunteer_only_var = party_popularity@ruling_party }
				multiply_variable = { volunteer_only_var = has_war_support }
				multiply_variable = { volunteer_only_var = 0.0045 }
				subtract_from_variable = { volunteer_only_var = 0.015 }
			}
			#Таймер недели
			#if = {
			#	limit = { NOT = { check_variable = { counter_days = 7 } } }
			#	add_to_variable = { counter_days = 1 }
			#}
			
			#ФИКСАЦИЯ ВЛИЯНИЯ И ОТНОШЕНИЯ ДУХОВЕНСТВА PER
			if = {
				limit = {
					original_tag = PER
					has_completed_focus = PER_islamic_revolution
					has_government = fascism
				}
				set_variable = { opinion_with_clergy_var = 10 }
				set_variable = { influence_of_clergy_var = 10 }
			}
			
			#communication_with_black_market_focus // generic
			if = {
				limit = {
					has_idea = communication_with_black_market_focus
					check_variable = { anarchism_tendency_need_trade_var > 0 }
				}
				add_equipment_to_stockpile = {
					type = infantry_equipment
					amount = anarchism_tendency_need_trade_var
				}
			}
			
			#ANARCHISM UNITY
			#СБРОС ПРИРОСТА ЕДИНСТВА
			if = {
				limit = {
					has_government = anarchism
					has_variable = anarchism_unity_daily_var
				}
				add_to_variable = { anarchism_unity_var = modifier@anarchist_unity_bonus }
				clamp_variable = { var = anarchism_unity_var min = 0 max = 100 }
			}
			
			#peoples_police // АНАРХИ
			if = {
				limit = {
					has_idea = peoples_police
				}
				add_equipment_to_stockpile = {
					type = infantry_equipment
					amount = 2
				}
			}
			#peoples_militia // АНАРХИ
			if = {
				limit = {
					has_idea = peoples_militia
				}
				add_equipment_to_stockpile = {
					type = infantry_equipment
					amount = 3
				}
			}
			
			if = {
				limit = {
					has_government = anarchism
				}
				set_var_for_anarchism_tendency_sense_of_danger_dyn = yes
				set_var_for_anarchism_tendency_interest_industry_dyn = yes
				set_var_for_anarchism_tendency_need_trade_dyn = yes
				update_anarchism_tendency_pool = yes
			}
		}
	}
	
	on_daily_KRD = {
		effect = {
			#KRD_colonization_neighboring_territories_kurds_category // Ежедневная численность населения в регионе
			if = {
				limit = {
					any_controlled_state = { check_variable = { state_manpower_coefficient_var > 0 } }
				}
				every_controlled_state = {
					limit = { check_variable = { state_manpower_coefficient_var > 0 } }
					add_manpower = var:state_manpower_var
				}
			}
			if = {
				limit = {
					has_variable = level_kurdish_westernization_var
				}
				add_to_variable = { level_kurdish_westernization_var = daily_level_kurdish_westernization_var }
				clamp_variable = { var = level_kurdish_westernization_var min = 0 max = 100 }
				if = {
					limit = {
						check_variable = { level_kurdish_westernization_var = 100 }
						NOT = { has_country_flag = kurdish_westernization_completed_flag }
					}
					set_country_flag = kurdish_westernization_completed_flag
					clear_variable = level_kurdish_westernization_var
				}
			}
		}
	}
	
	on_daily_SOV = {
		effect = {
			#Армянские спецслужбы // Решения PER
			if = {
				limit = { has_idea = PER_armenian_special_services }
				subtract_from_variable = { level_integration_south_azerbaijan = 0.01 }
			}
		}
	}
	
	on_daily_PER = {
		effect = {
			#PER_growth_of_suspicion_among_officers
			if = {
				limit = {
					has_idea = PER_growth_of_suspicion_among_officers
				}
				add_to_variable = { PER_army_tension_var = 0.1 }
				clamp_variable = { var = PER_army_tension_var min = 0 max = 100 }
			}
			#PER_dissatisfaction_due_decrease_in_salary
			if = {
				limit = {
					has_idea = PER_dissatisfaction_due_decrease_in_salary
				}
				add_to_variable = { PER_army_tension_var = 0.1 }
				clamp_variable = { var = PER_army_tension_var min = 0 max = 100 }
			}
			#ЧЕК 100% НАПРЯГИ ГЕНЕРАЛИТЕТА PER
			if = {
				limit = {
					tag = PER
					has_variable = PER_army_tension_var
					check_variable = { PER_army_tension_var = 100 }
					NOT = { has_country_flag = PER_army_tension_var_end_flag }
				}
				set_country_flag = PER_army_tension_var_end_flag
				country_event = { id = NWpersian.90 }
			}
			#PER_organize_an_uprising_in_tajikistan // PER
			if = {
				limit = {
					has_country_flag = PER_organize_an_uprising_in_tajikistan_flag
				}
				add_equipment_to_stockpile = {
					type = infantry_equipment
					amount = -10
				}
			}
			#PER_organize_an_uprising_in_azerbaijan // PER
			if = {
				limit = {
					has_country_flag = PER_organize_an_uprising_in_azerbaijan_flag
				}
				add_equipment_to_stockpile = {
					type = infantry_equipment
					amount = -10
				}
			}
		}
	}
	
	on_daily_BPL = {
		effect = {
			#СБРОС ПРИРОСТА НАПРЯГИ
			if = {
				limit = { has_variable = BPL_arab_tensions_total }
				set_variable = { BPL_arab_tensions_chance = modifier@arab_tensions_bonus }
			}
			if = {
				limit = { has_variable = BPL_jews_tensions_total }
				set_variable = { BPL_jews_tensions_chance = modifier@jews_tensions_bonus }
			}
			
			#Стремление к компромиссу // BPL
			if = {
				limit = {
					OR = {
						has_variable = BPL_arab_tensions_total
						has_variable = BPL_jews_tensions_total
					}
					has_idea = BPL_striving_for_compromise
				}
				if = {
					limit = {
						has_variable = BPL_arab_tensions_total
						check_variable = { BPL_arab_tensions_chance > 0 }
					}
					divide_variable = { BPL_arab_tensions_chance = 2 }
				}
				if = {
					limit = {
						has_variable = BPL_jews_tensions_total
						check_variable = { BPL_jews_tensions_chance > 0 }
					}
					divide_variable = { BPL_jews_tensions_chance = 2 }
				}
			}
			if = {
				limit = { has_variable = BPL_arab_tensions_total }
				add_to_variable = { BPL_arab_tensions_total = BPL_arab_tensions_chance }
				clamp_variable = { var = BPL_arab_tensions_total min = 0 max = 100 }
			}
			if = {
				limit = { has_variable = BPL_jews_tensions_total }
				add_to_variable = { BPL_jews_tensions_total = BPL_jews_tensions_chance }
				clamp_variable = { var = BPL_jews_tensions_total min = 0 max = 100 }
			}
			
			#BPL_legalize_arms_supplies_from_europe_idea // BPL
			if = {
				limit = {
					has_idea = BPL_legalize_arms_supplies_from_europe_idea
				}
				add_equipment_to_stockpile = {
					type = infantry_equipment
					amount = 2
				}
			}
		}
	}
	
	on_daily_TUR = {
		effect = {
			#TUR_send_kurds_from_region // Ежедневная численность населения в регионе: §R-300§!
			if = {
				limit = {
					any_owned_state = { has_state_flag = TUR_send_kurds_from_region_flag }
				}
				every_owned_state = {
					limit = { has_state_flag = TUR_send_kurds_from_region_flag }
					add_manpower = -300
				}
			}
		}
	}
	
	
	
	#ROOT is the nation being liberated, FROM is the leader of the liberators. 
	on_liberate = {
		effect = {
			ROOT = { country_event = { id = TRpolitical.106 } }
			if = {
				limit = {
					tag = KAS
					has_cosmetic_tag = KAS_SIK
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					tag = KUM
					has_cosmetic_tag = KUM_SIK
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					tag = DZH
					has_cosmetic_tag = DZH_SIK
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					tag = SYR
					has_cosmetic_tag = SYR_FRA
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					tag = LEB
					has_cosmetic_tag = LEB_FR
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					tag = LKA
					has_cosmetic_tag = LKA_ENG
					FROM = { original_tag = ENG }
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					tag = BPL
					has_cosmetic_tag = BPL_UK
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					tag = NFL
					has_cosmetic_tag = NFL_ENG
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					has_cosmetic_tag = BPL_technat_subject
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					has_cosmetic_tag = FIC_FRA
				}
				drop_cosmetic_tag = yes
			}
		}
	}
	
	# called when a country send volunteers to another
	# ROOT is sender, FROM is receiver
	on_send_volunteers = {
		effect = {
			#Чек FRF добровольцев в Испании
			if = {
				limit = {
					SPR_scw_in_progress = yes
					ROOT = {
						tag = FRF
						NOT = { has_country_flag = FRF_demand_balearic_islands_flag }
					}
					FROM = {
						OR = {
							tag = SPA
							tag = SPR
						}
					}
				}
				set_country_flag = FRF_demand_balearic_islands_flag
			}
			#Чек SOV добровольцев в Курдистане
			if = {
				limit = {
					KRD = { has_war_with = TUR }
					ROOT = {
						tag = SOV
						NOT = { has_country_flag = SOV_send_volunteers_kurds_flag }
					}
					FROM = { tag = KRD }
				}
				set_country_flag = SOV_send_volunteers_kurds_flag
			}
		}
	}
	
	#FROM is the nuked state. 
	on_nuke_drop = {
		#аннигиляция войск
		effect = {
			if = {
				limit = {
					NOT = {
						has_game_rule = {
							rule = nuclear_bomb_kill_army_status
							option = NUCLEAR_BOMB_KILL_ARMY_STATUS_OFF
						}
					}
				}
				every_country = { delete_unit = { state = FROM } }
				if = {
					limit = {
						has_game_rule = {
							rule = nuclear_bomb_kill_army_status
							option = NUCLEAR_BOMB_KILL_ARMY_STATUS_ON_HARD
						}
					}
					FROM = {
						every_neighbor_state = {
							every_country = { delete_unit = { state = PREV } }
						}
					}
				}
			}
		}
	}
	
	# scope is operative
	# FROM scope is the country 
	on_operative_created = {
		effect = {
			log = "[GetDateText]: ROOT: [Root.GetName] FROM: [From.GetName] on_operative_created"
			add_operative_nationalities = yes
		}
	}
	
	
	# FROM scope is the country // ROOT is unit leader
	on_unit_leader_created = {
		effect = {
			if = {
				limit = {
					FROM = { has_country_flag = guerrilla_war_flag }
				}
				add_unit_leader_trait = guerrilla_war_trait
			}
			if = {
				limit = {
					FROM = { has_country_flag = national_war_flag }
				}
				add_unit_leader_trait = national_war_trait
			}
		}
	}
	
}

